<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Example Modbus Library: C:/modbus/library/mbserial.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">modbus</a>&nbsp;&raquo&nbsp;<a class="el" href="../../dir_000001.html">library</a></div>
<h1>mbserial.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Example modbus serial API header file. 
<p>
This file contains higher level modbus serial utility functions. It supports both RTU and ASCII protocol and converts them implicity.<p>
History: Date Author Comment 08-02-2005 AceLan Kao. Create it.<p>
<dl compact><dt><b>Author:</b></dt><dd>AceLan Kao.(<a href="mailto:acelan_kao@moxa.com.tw">acelan_kao@moxa.com.tw</a>)</dd></dl>

<p>
Definition in file <a class="el" href="../../d4/d13/mbserial_8h-source.html">mbserial.h</a>.
<p>
<code>#include &quot;<a class="el" href="../../d8/d10/serial_8h-source.html">serial.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="../../d5/d2a/modbus__defs_8h-source.html">modbus_defs.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="../../d1/d17/modbus__utils_8h-source.html">modbus_utils.h</a>&quot;</code><br>

<p>
Include dependency graph for mbserial.h:<p><center><img src="../../d5/d5e/mbserial_8h__incl.png" border="0" usemap="#C:/modbus/library/mbserial.h_map" alt=""></center>
<map name="C:/modbus/library/mbserial.h_map">
<area href="../../db/d11/serial_8h.html" shape="rect" coords="275,184,339,211" alt="">
<area href="../../d7/dcc/modbus__defs_8h.html" shape="rect" coords="251,235,363,262" alt="">
<area href="../../d9/d8e/modbus__utils_8h.html" shape="rect" coords="251,286,363,312" alt="">
</map>

<p>
This graph shows which files directly or indirectly include this file:<p><center><img src="../../d5/d08/mbserial_8h__dep__incl.png" border="0" usemap="#C:/modbus/library/mbserial.hdep_map" alt=""></center>
<map name="C:/modbus/library/mbserial.hdep_map">
<area href="../../db/da4/mbserial_8c.html" shape="rect" coords="317,7,509,34" alt="">
<area href="../../d9/d00/simple-mbgateway_8c.html" shape="rect" coords="249,58,577,84" alt="">
</map>

<p>
<a href="../../d4/d13/mbserial_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dc6/structMB__SERIAL__INFO.html">MB_SERIAL_INFO</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a0">GETCLOCKMS</a>(x)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a1">GETCLOCKSECOND</a>(x)</td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a4">MBSerialBlockRead</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read ADU.  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a7">MBSerialClose</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">close the serial port  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a35">MBSerialDiagnostic</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Diagnostic request and get response(0x08)  <a href="#a35"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a8">MBSerialFlowCtrl</a> (int port, int control)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set flow control  <a href="#a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a18">MBSerialGetAddress</a> (const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *adu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get device address from ADU  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a12">MBSerialGetCharTimeout</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get char timeout  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a36">MBSerialGetCommEventCounter</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *eventcount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Get Comm Event Counter request and get response(0x0B)  <a href="#a36"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a37">MBSerialGetCommEventLog</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *eventcount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *messagecount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *events)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Get Comm Event Counter request and get response(0x0C)  <a href="#a37"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a10">MBSerialGetFrameTimeout</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get frame timeout  <a href="#a10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a19">MBSerialGetPDU</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *adu, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get PDU part from ADU data  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a14">MBSerialGetTimeout</a> (int port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get response timeout  <a href="#a14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a2">MBSerialInit</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus over serial line API.  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a32">MBSerialMaskWriteRegister</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> reg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> andmask, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ormask)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Mask Write Register request and get response(0x16)  <a href="#a32"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a5">MBSerialNonBlockRead</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">non-block read data from port  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a3">MBSerialOpen</a> (int port, int protocol)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">open serial port for modbus protocol  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a17">MBSerialReadASCII</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">read ASCII data from port  <a href="#a17"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a24">MBSerialReadCoils</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Coils request and get response(0x01)  <a href="#a24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a23">MBSerialReadDecreteInputs</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startdec, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus master function.  <a href="#a23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a34">MBSerialReadExceptionStatus</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus master function over serial only.  <a href="#a34"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a33">MBSerialReadFIFOQueue</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> FIFOAddr, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *FIFOCount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *FIFOValue)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read FIFO Queue request and get response(0x18)  <a href="#a33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a28">MBSerialReadHoldingRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Holding Registers request and get response(0x03)  <a href="#a28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a27">MBSerialReadInputRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Input Registers request and get response(0x04)  <a href="#a27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a16">MBSerialReadRTU</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">read RTU data from port  <a href="#a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a31">MBSerialReadWriteMultipleRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> rsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> rno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *rv, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> wsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> wno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *wv)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Write Multiple Registers request and get response(0x17)  <a href="#a31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a38">MBSerialReportSlaveID</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *slave_id, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Report Slave ID request and get response(0x11)  <a href="#a38"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a9">MBSerialSendAndWaitResponse</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, int len, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send adu packet through serial port and wait response adu from slave  <a href="#a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a48">MBSerialSendDiagnostic</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Diagnostic response(0x08)  <a href="#a48"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a49">MBSerialSendGetCommEventCounter</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> eventcount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Get Comm Event Counter response(0x0B)  <a href="#a49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a50">MBSerialSendGetCommEventLog</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> eventcount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> messagecount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *events)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Get Comm Event Counter response(0x0C)  <a href="#a50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a40">MBSerialSendReadCoils</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Coils response(0x01)  <a href="#a40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a39">MBSerialSendReadDecreteInputs</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus slave function or response to master.  <a href="#a39"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a47">MBSerialSendReadExecptionStatus</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Execption Status response(0x07)  <a href="#a47"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a46">MBSerialSendReadFIFOueue</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read FIFO Queue response(0x18)  <a href="#a46"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a42">MBSerialSendReadHoldingRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Holding Registers response(0x03)  <a href="#a42"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a41">MBSerialSendReadInputRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Read Input Registers response(0x04)  <a href="#a41"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a43">MBSerialSendWriteMultipleRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startdevreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> noreg)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Multiple Registers response(0x10)  <a href="#a43"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a44">MBSerialSendWriteSingleCoil</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> coilreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> onoff)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Single Coil response(0x05)  <a href="#a44"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a45">MBSerialSendWriteSingleRegister</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> addr, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Single Register response(0x06)  <a href="#a45"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a13">MBSerialSetCharTimeout</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set char timeout  <a href="#a13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a11">MBSerialSetFrameTimeout</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set frame timeout  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a20">MBSerialSetMode</a> (int port, unsigned int mode)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set serial port mode for RS232/RS422/RS485  <a href="#a20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a22">MBSerialSetParam</a> (int port, int parity, int databits, int stopbit)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set serial port parameter  <a href="#a22"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a21">MBSerialSetSpeed</a> (int port, unsigned int speed)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set serial speed and make changes now  <a href="#a21"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a15">MBSerialSetTimeout</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> timeout)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">set new response timeout  <a href="#a15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a6">MBSerialWrite</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, int len, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make ADU and sent out.  <a href="#a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a26">MBSerialWriteMultipleCoils</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Multiple Coils request and get response(0x0F)  <a href="#a26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a30">MBSerialWriteMultipleRegisters</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startdevreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> noreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Multiple Registers request and get response(0x10)  <a href="#a30"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a25">MBSerialWriteSingleCoil</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> coilreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> onoff)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Single Coil request and get response(0x05)  <a href="#a25"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d3e/mbserial_8h.html#a29">MBSerialWriteSingleRegister</a> (int port, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> devicereg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">send Write Single Register request and get response(0x06)  <a href="#a29"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0"></a><!-- doxytag: member="mbserial.h::GETCLOCKMS" ref="a0" args="(x)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define GETCLOCKMS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                                       \
                <span class="keyword">struct </span>timeval tv;                      \
                gettimeofday( &amp;tv, NULL);               \
                x= tv.tv_usec&gt;&gt;10;                      \
        }
</pre></div>
<p>
Definition at line <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00025">25</a> of file <a class="el" href="../../d4/d13/mbserial_8h-source.html">mbserial.h</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member="mbserial.h::GETCLOCKSECOND" ref="a1" args="(x)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define GETCLOCKSECOND          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                               \
                x= time(NULL);                          \
        }
</pre></div>
<p>
Definition at line <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00031">31</a> of file <a class="el" href="../../d4/d13/mbserial_8h-source.html">mbserial.h</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4"></a><!-- doxytag: member="mbserial.h::MBSerialBlockRead" ref="a4" args="(int port, u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialBlockRead           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read ADU. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer for store received data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>buffer length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>length of data actually read</dd></dl>
It blocks and reads data, and will return actually one frame of binary data On error return error code
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00243">243</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00031">MB_ASCII_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00077">MB_ERROR_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00030">MB_RTU_PROTOCOL</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>, and <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00037">MB_SERIAL_INFO::Protocol</a>.
<p>
Referenced by <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00035">serial_master_child()</a>.<div class="fragment"><pre class="fragment"><a name="l00244"></a>00244 {
<a name="l00245"></a>00245         <span class="keywordtype">int</span> ret_len= 0;
<a name="l00246"></a>00246         <span class="keywordflow">if</span>( <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a> == <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a4">MB_RTU_PROTOCOL</a>)
<a name="l00247"></a>00247                 ret_len= <a class="code" href="../../db/da4/mbserial_8c.html#a3">MBSerialReadRTU</a>( port, buf, len);
<a name="l00248"></a>00248         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a> == <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a5">MB_ASCII_PROTOCOL</a>)
<a name="l00249"></a>00249                 ret_len= <a class="code" href="../../db/da4/mbserial_8c.html#a4">MBSerialReadASCII</a>( port, buf, len);
<a name="l00250"></a>00250         <span class="keywordflow">else</span>
<a name="l00251"></a>00251                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a46">MB_ERROR_PROTOCOL</a>;
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         <span class="keywordflow">return</span> ret_len;
<a name="l00254"></a>00254 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a4_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a4_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a4_cgraph_map">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="196,159,340,185" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="200,285,336,312" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="623,235,689,261" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="457,57,505,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="421,7,541,33" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="408,159,555,185" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="421,209,541,236" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="399,260,564,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="449,361,513,388" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="393,412,569,439" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="388,463,575,489" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a7"></a><!-- doxytag: member="mbserial.h::MBSerialClose" ref="a7" args="(int port)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialClose           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>port</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
close the serial port 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00297">297</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00145">SerialClose()</a>.<div class="fragment"><pre class="fragment"><a name="l00298"></a>00298 {
<a name="l00299"></a>00299         <span class="comment">// TODO : need to do more checking before close</span>
<a name="l00300"></a>00300         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a8">SerialClose</a>( port);
<a name="l00301"></a>00301 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a7_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a7_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a7_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a8" shape="rect" coords="167,7,258,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="306,7,372,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a35"></a><!-- doxytag: member="mbserial.h::MBSerialDiagnostic" ref="a35" args="(int port, u8 address, u16 subfunc, u16 data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Diagnostic request and get response(0x08) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to be sent to slave device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00912">912</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00640">MBDiagnostic()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01467">MBGetResponseDiagnostic()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00913"></a>00913 {
<a name="l00914"></a>00914         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00915"></a>00915         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00916"></a>00916         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_subfunc, ret_data;
<a name="l00917"></a>00917 
<a name="l00919"></a>00919         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a23">MBDiagnostic</a>( pdu, subfunc, data);
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00922"></a>00922 
<a name="l00923"></a>00923         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00924"></a>00924                 <span class="keywordflow">return</span> adu_len;
<a name="l00925"></a>00925 
<a name="l00926"></a>00926         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00927"></a>00927         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a61">MBGetResponseDiagnostic</a>( pdu, &amp;ret_subfunc, &amp;ret_data);
<a name="l00928"></a>00928 
<a name="l00929"></a>00929         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00930"></a>00930                 <span class="keywordflow">return</span> ret;
<a name="l00931"></a>00931         <span class="keywordflow">if</span>( ( ret_subfunc != subfunc) || ( ret_data != data))
<a name="l00932"></a>00932                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00935"></a>00935 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a35_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a35_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a35_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a23" shape="rect" coords="251,159,355,186" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="257,210,348,236" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a61" shape="rect" coords="211,260,395,287" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="193,311,412,338" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="460,159,604,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="464,311,600,338" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="477,463,587,490" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="913,260,980,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="923,387,971,414" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="685,7,805,34" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="672,210,819,236" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="685,159,805,186" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="663,260,828,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="915,564,979,591" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="657,362,833,388" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="652,412,839,439" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="695,514,796,540" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="701,463,789,490" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="887,514,1007,540" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a8"></a><!-- doxytag: member="mbserial.h::MBSerialFlowCtrl" ref="a8" args="(int port, int control)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialFlowCtrl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>control</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set flow control 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>control</em>&nbsp;</td><td>HW_FLOW_CONTROL or SW_FLOW_CONTROL </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00311">311</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00188">SerialFlowControl()</a>.<div class="fragment"><pre class="fragment"><a name="l00312"></a>00312 {
<a name="l00313"></a>00313         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a10">SerialFlowControl</a>( port, control);
<a name="l00314"></a>00314 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a8_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a8_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a8_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a10" shape="rect" coords="183,7,311,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="359,7,425,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a18"></a><!-- doxytag: member="mbserial.h::MBSerialGetAddress" ref="a18" args="(const u8 *adu)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> MBSerialGetAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>adu</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get device address from ADU 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>adu</em>&nbsp;</td><td>ADU data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00446">446</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00321">MBGetAddress()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00035">serial_master_child()</a>, and <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00158">serial_slave_child()</a>.<div class="fragment"><pre class="fragment"><a name="l00447"></a>00447 {
<a name="l00448"></a>00448         <span class="keywordflow">return</span> <a class="code" href="../../d4/d81/modbus__utils_8c.html#a9">MBGetAddress</a>( adu);
<a name="l00449"></a>00449 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a18_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a18_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a18_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a9" shape="rect" coords="201,7,313,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a12"></a><!-- doxytag: member="mbserial.h::MBSerialGetCharTimeout" ref="a12" args="(int port)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> MBSerialGetCharTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>port</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get char timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>char timeout value</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00396">396</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00039">MB_SERIAL_INFO::CharTimeout</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.<div class="fragment"><pre class="fragment"><a name="l00397"></a>00397 {
<a name="l00398"></a>00398         <span class="keywordflow">return</span> <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o0">CharTimeout</a>;
<a name="l00399"></a>00399 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36"></a><!-- doxytag: member="mbserial.h::MBSerialGetCommEventCounter" ref="a36" args="(int port, u8 address, u16 *status, u16 *eventcount)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialGetCommEventCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Get Comm Event Counter request and get response(0x0B) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00947">947</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00660">MBGetCommEventCounter()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01487">MBGetResponseGetCommEventCounter()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00948"></a>00948 {
<a name="l00949"></a>00949         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00950"></a>00950         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00951"></a>00951 
<a name="l00953"></a>00953         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a24">MBGetCommEventCounter</a>( pdu);
<a name="l00954"></a>00954 
<a name="l00955"></a>00955         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00956"></a>00956 
<a name="l00957"></a>00957         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00958"></a>00958                 <span class="keywordflow">return</span> adu_len;
<a name="l00959"></a>00959 
<a name="l00960"></a>00960         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00961"></a>00961         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a62">MBGetResponseGetCommEventCounter</a>( pdu,  status,  eventcount);
<a name="l00962"></a>00962 
<a name="l00963"></a>00963         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00964"></a>00964                 <span class="keywordflow">return</span> ret;
<a name="l00965"></a>00965 
<a name="l00966"></a>00966         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00967"></a>00967 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a36_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a36_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a36_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a24" shape="rect" coords="316,7,503,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="364,58,455,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a62" shape="rect" coords="276,108,543,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="300,159,519,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="591,108,735,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="595,159,731,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="608,210,717,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a37"></a><!-- doxytag: member="mbserial.h::MBSerialGetCommEventLog" ref="a37" args="(int port, u8 address, u16 *status, u16 *eventcount, u16 *messagecount, u8 *events)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialGetCommEventLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>messagecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>events</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Get Comm Event Counter request and get response(0x0C) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>messagecount</em>&nbsp;</td><td>counter for processed message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>events</em>&nbsp;</td><td>new events </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00981">981</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00676">MBGetCommEventLog()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01509">MBGetResponseGetCommEventLog()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00982"></a>00982 {
<a name="l00983"></a>00983         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00984"></a>00984         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00985"></a>00985 
<a name="l00987"></a>00987         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a25">MBGetCommEventLog</a>( pdu);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00990"></a>00990 
<a name="l00991"></a>00991         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00992"></a>00992                 <span class="keywordflow">return</span> adu_len;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00995"></a>00995         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a63">MBGetResponseGetCommEventLog</a>( pdu, status, eventcount, messagecount, events);
<a name="l00996"></a>00996 
<a name="l00997"></a>00997         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00998"></a>00998                 <span class="keywordflow">return</span> ret;
<a name="l00999"></a>00999 
<a name="l01000"></a>01000         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01001"></a>01001 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a37_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a37_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a37_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a25" shape="rect" coords="293,7,453,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="328,58,419,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a63" shape="rect" coords="252,108,495,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="264,159,483,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="543,108,687,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="547,159,683,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="560,210,669,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a10"></a><!-- doxytag: member="mbserial.h::MBSerialGetFrameTimeout" ref="a10" args="(int port)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> MBSerialGetFrameTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>port</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get frame timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>frame timeout value</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00371">371</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00038">MB_SERIAL_INFO::FrameTimeout</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.<div class="fragment"><pre class="fragment"><a name="l00372"></a>00372 {
<a name="l00373"></a>00373         <span class="keywordflow">return</span> <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o1">FrameTimeout</a>;
<a name="l00374"></a>00374 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19"></a><!-- doxytag: member="mbserial.h::MBSerialGetPDU" ref="a19" args="(u8 *buf, u8 *adu, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialGetPDU           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>adu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get PDU part from ADU data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>adu</em>&nbsp;</td><td>ADU data with error check code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the adu data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00460">460</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00035">serial_master_child()</a>, and <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00158">serial_slave_child()</a>.<div class="fragment"><pre class="fragment"><a name="l00461"></a>00461 {
<a name="l00462"></a>00462         <span class="keywordflow">return</span> <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( buf, adu, len);
<a name="l00463"></a>00463 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a19_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a19_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a19_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="184,7,275,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a14"></a><!-- doxytag: member="mbserial.h::MBSerialGetTimeout" ref="a14" args="(int port)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> MBSerialGetTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>port</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get response timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>timeout value</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00421">421</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00040">MB_SERIAL_INFO::Timeout</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.<div class="fragment"><pre class="fragment"><a name="l00422"></a>00422 {
<a name="l00423"></a>00423         <span class="keywordflow">return</span> <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o3">Timeout</a>;
<a name="l00424"></a>00424 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a2"></a><!-- doxytag: member="mbserial.h::MBSerialInit" ref="a2" args="(void)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MBSerialInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus over serial line API. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>
&lt; in seconds 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00029">29</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00039">MB_SERIAL_INFO::CharTimeout</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00038">MB_SERIAL_INFO::FrameTimeout</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00037">MB_SERIAL_INFO::Protocol</a>, and <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00040">MB_SERIAL_INFO::Timeout</a>.
<p>
Referenced by <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00276">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00030"></a>00030 {
<a name="l00031"></a>00031         <span class="keywordtype">int</span> i= 0;
<a name="l00032"></a>00032 
<a name="l00033"></a>00033         <span class="keywordflow">for</span>( i= 0; i&lt; <a class="code" href="../../db/d11/serial_8h.html#a8">MAX_PORT_NUM</a>; i++)
<a name="l00034"></a>00034         {
<a name="l00035"></a>00035                 <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ i].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a>= -1;
<a name="l00036"></a>00036                 <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ i].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o1">FrameTimeout</a>= 3000;
<a name="l00037"></a>00037                 <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ i].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o0">CharTimeout</a>= 100;
<a name="l00038"></a>00038                 <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ i].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o3">Timeout</a>= 3;            
<a name="l00039"></a>00039         }
<a name="l00040"></a>00040 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32"></a><!-- doxytag: member="mbserial.h::MBSerialMaskWriteRegister" ref="a32" args="(int port, u8 address, u16 reg, u16 andmask, u16 ormask)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialMaskWriteRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>andmask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ormask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Mask Write Register request and get response(0x16) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>andmask</em>&nbsp;</td><td>and mask </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ormask</em>&nbsp;</td><td>or mask </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00813">813</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01557">MBGetResponseMaskWriteRegister()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00578">MBMaskWriteRegister()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00814"></a>00814 {
<a name="l00815"></a>00815         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00816"></a>00816         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00817"></a>00817         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_reg, ret_and, ret_or;
<a name="l00818"></a>00818 
<a name="l00820"></a>00820         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a20">MBMaskWriteRegister</a>( pdu, reg, andmask, ormask);
<a name="l00821"></a>00821 
<a name="l00822"></a>00822         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00823"></a>00823 
<a name="l00824"></a>00824         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00825"></a>00825                 <span class="keywordflow">return</span> adu_len;
<a name="l00826"></a>00826 
<a name="l00827"></a>00827         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00828"></a>00828         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a65">MBGetResponseMaskWriteRegister</a>( pdu, &amp;ret_reg, &amp;ret_and, &amp;ret_or);
<a name="l00829"></a>00829 
<a name="l00830"></a>00830         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00831"></a>00831                 <span class="keywordflow">return</span> ret;
<a name="l00832"></a>00832         <span class="keywordflow">if</span>( ( ret_reg != reg) || ( ret_and != andmask) || ( ret_or != ormask))
<a name="l00833"></a>00833                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00834"></a>00834         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00835"></a>00835 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a32_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a32_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a32_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="320,160,411,187" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a65" shape="rect" coords="248,211,483,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a20" shape="rect" coords="288,262,443,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="256,312,475,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="532,160,676,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="536,312,672,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="549,515,659,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="959,262,1025,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="968,363,1016,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="757,110,877,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="744,160,891,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="757,211,877,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="735,262,900,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="960,515,1024,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="729,312,905,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="724,363,911,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="767,566,868,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="773,515,861,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member="mbserial.h::MBSerialNonBlockRead" ref="a5" args="(int port, u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialNonBlockRead           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
non-block read data from port 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer for store received data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>buffer length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>length of data actually read</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00265">265</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00100">SerialNonBlockRead()</a>.<div class="fragment"><pre class="fragment"><a name="l00266"></a>00266 {
<a name="l00267"></a>00267         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a6">SerialNonBlockRead</a>( port, (<span class="keywordtype">char</span> *)buf, len);
<a name="l00268"></a>00268 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a5_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a5_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a5_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a6" shape="rect" coords="221,7,365,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="415,7,481,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member="mbserial.h::MBSerialOpen" ref="a3" args="(int port, int protocol)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialOpen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>protocol</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
open serial port for modbus protocol 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>protocol</em>&nbsp;</td><td>which protocol this port use </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
&lt; clear struct for new port settings<p>
&lt; inter-character timer unused<p>
&lt; blocking read until 1 character arrives 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00050">50</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00031">MB_ASCII_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00067">MB_ERROR_OPEN</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00077">MB_ERROR_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00030">MB_RTU_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00032">MB_TCP_PROTOCOL</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00037">MB_SERIAL_INFO::Protocol</a>, and <a class="el" href="../../d0/d17/serial_8c-source.html#l00047">SerialOpen()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00105">serial_master()</a>, and <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00211">serial_slave()</a>.<div class="fragment"><pre class="fragment"><a name="l00051"></a>00051 {
<a name="l00052"></a>00052         <span class="keywordtype">int</span> RetValue;
<a name="l00053"></a>00053         <span class="keyword">struct </span>termios tio;
<a name="l00054"></a>00054         <span class="keywordflow">if</span>( ( protocol != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a4">MB_RTU_PROTOCOL</a>)
<a name="l00055"></a>00055                 &amp;&amp; ( protocol != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a5">MB_ASCII_PROTOCOL</a>)
<a name="l00056"></a>00056                 &amp;&amp; ( protocol != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a6">MB_TCP_PROTOCOL</a>))
<a name="l00057"></a>00057                 <span class="keywordflow">return</span> ( <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a46">MB_ERROR_PROTOCOL</a>);
<a name="l00058"></a>00058 
<a name="l00059"></a>00059         bzero(&amp;tio, <span class="keyword">sizeof</span>(tio));       
<a name="l00060"></a>00060 
<a name="l00061"></a>00061         tio.c_iflag = 0;
<a name="l00062"></a>00062         tio.c_oflag = 0;
<a name="l00063"></a>00063         tio.c_cflag = B9600|CS8|CREAD|CLOCAL;
<a name="l00064"></a>00064         tio.c_lflag = 0;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         tio.c_cc[ VTIME] = 0;           
<a name="l00067"></a>00067         tio.c_cc[ VMIN] = 1;            
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         RetValue= <a class="code" href="../../d8/d90/serial_8c.html#a4">SerialOpen</a>( port, O_RDWR|O_NOCTTY, &amp;tio);
<a name="l00070"></a>00070         <span class="keywordflow">if</span>( RetValue &lt; 0)
<a name="l00071"></a>00071                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a36">MB_ERROR_OPEN</a>;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073         <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a>= protocol;
<a name="l00074"></a>00074 
<a name="l00075"></a>00075         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00076"></a>00076 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a3_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a3_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a3_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a4" shape="rect" coords="165,7,253,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a17"></a><!-- doxytag: member="mbserial.h::MBSerialReadASCII" ref="a17" args="(int port, u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadASCII           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
read ASCII data from port 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer for store received data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>buffer length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>length of data actually read</dd></dl>
It will block to read data, and will return actually one frame of binary data It will verify the data, if format error, it return MB_ERROR_FORMAT<p>
&lt; ascii char timeout<p>
Serial timeout 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">158</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00030">FindFD()</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00031">GETCLOCKSECOND</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00107">LRC()</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00064">MB_ERROR_FORMAT</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00132">MBASCIIToData()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00421">MBSerialGetTimeout()</a>, <a class="el" href="../../d0/d17/serial_8c-source.html#l00124">SerialBlockRead()</a>, and <a class="el" href="../../d0/d17/serial_8c-source.html#l00168">SerialDataInInputQueue()</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00243">MBSerialBlockRead()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00159"></a>00159 {
<a name="l00160"></a>00160         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> tmp[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>];
<a name="l00161"></a>00161         <span class="keywordtype">int</span> tmp_len= 0, ret_len= 0, end_flag= 0;
<a name="l00162"></a>00162         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> starttime, endtime;
<a name="l00163"></a>00163         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ch;
<a name="l00164"></a>00164         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> lrc;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166         <span class="keyword">struct </span>timeval tv;
<a name="l00167"></a>00167         <span class="keywordtype">int</span> readsocks, len1= 0, len2= 0;
<a name="l00168"></a>00168         fd_set fdset;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         tv.tv_sec = 1;                                  
<a name="l00171"></a>00171         tv.tv_usec = 0;
<a name="l00172"></a>00172 
<a name="l00174"></a>00174         <a class="code" href="../../d0/d3e/mbserial_8h.html#a1">GETCLOCKSECOND</a>( starttime);
<a name="l00175"></a>00175         <span class="keywordflow">while</span>( 1)
<a name="l00176"></a>00176         {
<a name="l00177"></a>00177                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d90/serial_8c.html#a9">SerialDataInInputQueue</a>( port) &gt; 2)
<a name="l00178"></a>00178                         <span class="keywordflow">break</span>;
<a name="l00179"></a>00179                 <a class="code" href="../../d0/d3e/mbserial_8h.html#a1">GETCLOCKSECOND</a>( endtime);
<a name="l00180"></a>00180                 <span class="keywordflow">if</span>( (endtime-starttime) &gt; <a class="code" href="../../db/da4/mbserial_8c.html#a16">MBSerialGetTimeout</a>( port))
<a name="l00181"></a>00181                         <span class="keywordflow">return</span> 0;
<a name="l00182"></a>00182         }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="keywordflow">do</span>
<a name="l00185"></a>00185         {
<a name="l00186"></a>00186                 <a class="code" href="../../d8/d90/serial_8c.html#a7">SerialBlockRead</a>( port, (<span class="keywordtype">char</span> *)&amp;ch, 1);
<a name="l00187"></a>00187         }<span class="keywordflow">while</span>( ch != <span class="charliteral">':'</span>);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         FD_ZERO(&amp;fdset);
<a name="l00190"></a>00190         FD_SET( <a class="code" href="../../d8/d90/serial_8c.html#a3">FindFD</a>(port), &amp;fdset);
<a name="l00191"></a>00191         <span class="keywordflow">while</span>( 1)
<a name="l00192"></a>00192         {
<a name="l00193"></a>00193                 readsocks = select( <a class="code" href="../../d8/d90/serial_8c.html#a3">FindFD</a>(port)+ 1, &amp;fdset, NULL, NULL, &amp;tv);
<a name="l00194"></a>00194                 <span class="keywordflow">if</span>(readsocks == 0)                      <span class="comment">// char timeout</span>
<a name="l00195"></a>00195                         <span class="keywordflow">break</span>;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d90/serial_8c.html#a7">SerialBlockRead</a>( port, (<span class="keywordtype">char</span> *)&amp;ch, 1))
<a name="l00198"></a>00198                 {
<a name="l00199"></a>00199                         <span class="keywordflow">if</span>( ch == <span class="charliteral">':'</span>)                  <span class="comment">// a new frame start here!!</span>
<a name="l00200"></a>00200                         {                               <span class="comment">// normally, we'll drop a frame</span>
<a name="l00201"></a>00201                                 tmp_len= 0;             <span class="comment">// but it's better to read it in</span>
<a name="l00202"></a>00202                         }
<a name="l00203"></a>00203                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch == 0x0d)            <span class="comment">// prepare to stop</span>
<a name="l00204"></a>00204                         {
<a name="l00205"></a>00205                                 <span class="keywordflow">if</span>( end_flag == 0)
<a name="l00206"></a>00206                                         end_flag= 1;
<a name="l00207"></a>00207                                 <span class="keywordflow">else</span>                    <span class="comment">// receive two CR char</span>
<a name="l00208"></a>00208                                         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>;
<a name="l00209"></a>00209                         }
<a name="l00210"></a>00210                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( ch == 0x0a)
<a name="l00211"></a>00211                         {
<a name="l00212"></a>00212                                 <span class="keywordflow">if</span>( end_flag == 1)      <span class="comment">// actually one frame receive</span>
<a name="l00213"></a>00213                                         <span class="keywordflow">break</span>;
<a name="l00214"></a>00214                                 <span class="keywordflow">else</span>
<a name="l00215"></a>00215                                         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>;
<a name="l00216"></a>00216                         }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218                         tmp[ tmp_len++]= ch;
<a name="l00219"></a>00219                 }
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221         ret_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a4">MBASCIIToData</a>( buf, tmp, tmp_len);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223         <span class="comment">// check LRC</span>
<a name="l00224"></a>00224         lrc= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a3">LRC</a>( buf, ret_len- 1);
<a name="l00225"></a>00225         <span class="keywordflow">if</span>( lrc != buf[ ret_len- 1])
<a name="l00226"></a>00226                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228         <span class="keywordflow">return</span> ret_len;
<a name="l00229"></a>00229 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a17_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a17_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a17_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="412,209,479,236" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="257,57,305,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="221,108,341,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="208,159,355,185" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="221,209,341,236" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="199,260,364,287" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a24"></a><!-- doxytag: member="mbserial.h::MBSerialReadCoils" ref="a24" args="(int port, u8 address, u16 startcoils, u16 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Coils request and get response(0x01) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register numbere </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>coils status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of status bytes, on error return error code</dd></dl>
&lt; make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00540">540</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01280">MBGetResponseReadCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00371">MBReadCoils()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00541"></a>00541 {
<a name="l00542"></a>00542         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00543"></a>00543         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00544"></a>00544         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ret_no;
<a name="l00545"></a>00545 
<a name="l00546"></a>00546         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a12">MBReadCoils</a>( pdu, startcoils, no);             
<a name="l00547"></a>00547 
<a name="l00548"></a>00548         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00549"></a>00549 
<a name="l00550"></a>00550         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00551"></a>00551                 <span class="keywordflow">return</span> adu_len;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00554"></a>00554         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a52">MBGetResponseReadCoils</a>( pdu, &amp;ret_no, value);
<a name="l00555"></a>00555         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00556"></a>00556                 <span class="keywordflow">return</span> ret;
<a name="l00557"></a>00557         <span class="keywordflow">return</span> ret_no;
<a name="l00558"></a>00558 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a24_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a24_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a24_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="257,159,348,186" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a52" shape="rect" coords="211,210,395,236" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a12" shape="rect" coords="251,260,355,287" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="193,311,412,338" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="460,159,604,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="464,311,600,338" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="477,463,587,490" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="913,260,980,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="923,387,971,414" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="685,7,805,34" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="672,210,819,236" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="685,159,805,186" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="663,260,828,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="915,564,979,591" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="657,362,833,388" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="652,412,839,439" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="695,514,796,540" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="701,463,789,490" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="887,514,1007,540" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a23"></a><!-- doxytag: member="mbserial.h::MBSerialReadDecreteInputs" ref="a23" args="(int port, u8 address, u16 startdec, u16 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startdec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus master function. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startdec</em>&nbsp;</td><td>starting decrete inputs register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of status bytes, on error return error code</dd></dl>
&lt; make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00509">509</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01258">MBGetResponseReadDecreteInputs()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00349">MBReadDecreteInputs()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00510"></a>00510 {
<a name="l00511"></a>00511         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00512"></a>00512         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00513"></a>00513         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ret_no;
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a11">MBReadDecreteInputs</a>( pdu, startdec, no);       
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00520"></a>00520                 <span class="keywordflow">return</span> adu_len;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00523"></a>00523         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a51">MBGetResponseReadDecreteInputs</a>( pdu, &amp;ret_no, value);
<a name="l00524"></a>00524         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00525"></a>00525                 <span class="keywordflow">return</span> ret;
<a name="l00526"></a>00526         <span class="keywordflow">return</span> ret_no;
<a name="l00527"></a>00527 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a23_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a23_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a23_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="320,160,411,187" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a51" shape="rect" coords="247,211,484,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a11" shape="rect" coords="287,262,444,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="256,312,475,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="532,160,676,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="536,312,672,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="549,515,659,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="959,262,1025,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="968,363,1016,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="757,110,877,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="744,160,891,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="757,211,877,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="735,262,900,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="960,515,1024,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="729,312,905,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="724,363,911,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="767,566,868,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="773,515,861,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a34"></a><!-- doxytag: member="mbserial.h::MBSerialReadExceptionStatus" ref="a34" args="(int port, u8 address, u8 *status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadExceptionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus master function over serial only. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>eight exception status in one byte </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00880">880</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01448">MBGetResponseReadExceptionStatus()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00622">MBReadExceptionStatus()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00881"></a>00881 {
<a name="l00882"></a>00882         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00883"></a>00883         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00884"></a>00884 
<a name="l00886"></a>00886         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a22">MBReadExceptionStatus</a>( pdu);
<a name="l00887"></a>00887 
<a name="l00888"></a>00888         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00891"></a>00891                 <span class="keywordflow">return</span> adu_len;
<a name="l00892"></a>00892 
<a name="l00893"></a>00893         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00894"></a>00894         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a60">MBGetResponseReadExceptionStatus</a>( pdu, status);
<a name="l00895"></a>00895 
<a name="l00896"></a>00896         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00897"></a>00897                 <span class="keywordflow">return</span> ret;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00900"></a>00900 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a34_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a34_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a34_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="341,7,432,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a60" shape="rect" coords="261,58,512,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a22" shape="rect" coords="301,108,472,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="277,159,496,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="561,108,705,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="565,159,701,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="579,210,688,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a33"></a><!-- doxytag: member="mbserial.h::MBSerialReadFIFOQueue" ref="a33" args="(int port, u8 address, u16 FIFOAddr, u16 *FIFOCount, u16 *FIFOValue)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadFIFOQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FIFOAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>FIFOCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>FIFOValue</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read FIFO Queue request and get response(0x18) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FIFOAddr</em>&nbsp;</td><td>FIFO address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FIFOCount</em>&nbsp;</td><td>FIFO value buffer size(&lt;=31) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FIFOValue</em>&nbsp;</td><td>values of FIFO register </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00848">848</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01426">MBGetResponseReadFIFOQueue()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00601">MBReadFIFOQueue()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00849"></a>00849 {
<a name="l00850"></a>00850         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00851"></a>00851         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00852"></a>00852 
<a name="l00854"></a>00854         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a21">MBReadFIFOQueue</a>( pdu, FIFOAddr);
<a name="l00855"></a>00855 
<a name="l00856"></a>00856         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00857"></a>00857 
<a name="l00858"></a>00858         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00859"></a>00859                 <span class="keywordflow">return</span> adu_len;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00862"></a>00862         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a59">MBGetResponseReadFIFOQueue</a>( pdu, FIFOCount, FIFOValue);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00865"></a>00865                 <span class="keywordflow">return</span> ret;
<a name="l00866"></a>00866 
<a name="l00867"></a>00867         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00868"></a>00868 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a33_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a33_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a33_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="304,160,395,187" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a59" shape="rect" coords="236,211,463,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a21" shape="rect" coords="278,262,422,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="240,312,459,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="511,160,655,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="515,312,651,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="528,515,638,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="938,262,1004,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="947,363,995,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="736,110,856,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="723,160,870,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="736,211,856,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="714,262,879,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="939,515,1003,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="708,312,884,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="703,363,890,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="746,566,847,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="752,515,840,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a28"></a><!-- doxytag: member="mbserial.h::MBSerialReadHoldingRegisters" ref="a28" args="(int port, u8 address, u16 startreg, u16 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Holding Registers request and get response(0x03) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>register status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of registers for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00674">674</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01324">MBGetResponseReadHoldingRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00469">MBReadHoldingRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00675"></a>00675 {
<a name="l00676"></a>00676         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00677"></a>00677         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00678"></a>00678         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ret_no;
<a name="l00679"></a>00679 
<a name="l00681"></a>00681         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a16">MBReadHoldingRegisters</a>( pdu, startreg, no);
<a name="l00682"></a>00682 
<a name="l00683"></a>00683         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00686"></a>00686                 <span class="keywordflow">return</span> adu_len;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00689"></a>00689         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a54">MBGetResponseReadHoldingRegisters</a>( pdu, &amp;ret_no, value);
<a name="l00690"></a>00690         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00691"></a>00691                 <span class="keywordflow">return</span> ret;
<a name="l00692"></a>00692         <span class="keywordflow">return</span> ret_no;
<a name="l00693"></a>00693 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a28_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a28_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a28_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="348,7,439,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a54" shape="rect" coords="265,58,521,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a16" shape="rect" coords="305,108,481,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="284,159,503,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="569,108,713,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="573,159,709,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="587,210,696,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a27"></a><!-- doxytag: member="mbserial.h::MBSerialReadInputRegisters" ref="a27" args="(int port, u8 address, u16 startreg, u16 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Input Registers request and get response(0x04) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>register status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>number of registers for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00642">642</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01302">MBGetResponseReadInputRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00447">MBReadInputRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00643"></a>00643 {
<a name="l00644"></a>00644         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00645"></a>00645         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00646"></a>00646         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ret_no;
<a name="l00647"></a>00647 
<a name="l00649"></a>00649         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a15">MBReadInputRegisters</a>( pdu, startreg, no);
<a name="l00650"></a>00650 
<a name="l00651"></a>00651         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00654"></a>00654                 <span class="keywordflow">return</span> adu_len;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00657"></a>00657         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a53">MBGetResponseReadInputRegisters</a>( pdu, &amp;ret_no, value);
<a name="l00658"></a>00658         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00659"></a>00659                 <span class="keywordflow">return</span> ret;
<a name="l00660"></a>00660         <span class="keywordflow">return</span> ret_no;
<a name="l00661"></a>00661 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a27_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a27_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a27_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="326,7,416,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a53" shape="rect" coords="251,58,491,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a15" shape="rect" coords="291,108,451,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="262,159,480,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="540,108,684,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="544,159,680,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="558,210,667,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a16"></a><!-- doxytag: member="mbserial.h::MBSerialReadRTU" ref="a16" args="(int port, u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadRTU           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
read RTU data from port 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>buffer for store received data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>buffer length </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>length of data actually read</dd></dl>
It will block to read data, and will return actually one frame of binary data It will verify the data, if format error, it return MB_ERROR_FORMAT<p>
&lt; char timeout<p>
Serial timeout<p>
&lt; for frame timeout<p>
&lt; char timeout<p>
&lt; frame timeout<p>
&lt; number loop back 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">90</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00079">CRC16()</a>, <a class="el" href="../../d0/d17/serial_8c-source.html#l00030">FindFD()</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00025">GETCLOCKMS</a>, <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00031">GETCLOCKSECOND</a>, <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00064">MB_ERROR_FORMAT</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00396">MBSerialGetCharTimeout()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00371">MBSerialGetFrameTimeout()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00421">MBSerialGetTimeout()</a>, <a class="el" href="../../d0/d17/serial_8c-source.html#l00124">SerialBlockRead()</a>, <a class="el" href="../../d0/d17/serial_8c-source.html#l00168">SerialDataInInputQueue()</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00024">U32_MAX_VALUE</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00243">MBSerialBlockRead()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00091"></a>00091 {
<a name="l00092"></a>00092         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a> starttime, endtime;
<a name="l00093"></a>00093         <span class="keyword">struct </span>timeval tv;
<a name="l00094"></a>00094         <span class="keywordtype">int</span> readsocks, len1= 0, len2= 0;
<a name="l00095"></a>00095         fd_set fdset;
<a name="l00096"></a>00096         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> crc, org_crc;
<a name="l00097"></a>00097 
<a name="l00098"></a>00098         tv.tv_sec = 0;                                  
<a name="l00099"></a>00099         tv.tv_usec = <a class="code" href="../../db/da4/mbserial_8c.html#a14">MBSerialGetCharTimeout</a>( port)* 1000;
<a name="l00100"></a>00100 
<a name="l00102"></a>00102         <a class="code" href="../../d0/d3e/mbserial_8h.html#a1">GETCLOCKSECOND</a>( starttime);
<a name="l00103"></a>00103         <span class="keywordflow">while</span>( 1)
<a name="l00104"></a>00104         {
<a name="l00105"></a>00105                 <span class="keywordflow">if</span>( <a class="code" href="../../d8/d90/serial_8c.html#a9">SerialDataInInputQueue</a>( port) &gt; 2)
<a name="l00106"></a>00106                         <span class="keywordflow">break</span>;
<a name="l00107"></a>00107                 <a class="code" href="../../d0/d3e/mbserial_8h.html#a1">GETCLOCKSECOND</a>( endtime);
<a name="l00108"></a>00108                 <span class="keywordflow">if</span>( (endtime-starttime) &gt; <a class="code" href="../../db/da4/mbserial_8c.html#a16">MBSerialGetTimeout</a>( port))
<a name="l00109"></a>00109                         <span class="keywordflow">return</span> 0;
<a name="l00110"></a>00110         }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         len1= <a class="code" href="../../d8/d90/serial_8c.html#a7">SerialBlockRead</a>( port, (<span class="keywordtype">char</span> *)buf, len);
<a name="l00113"></a>00113         <a class="code" href="../../d0/d3e/mbserial_8h.html#a0">GETCLOCKMS</a>( starttime);                         
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         FD_ZERO(&amp;fdset);
<a name="l00116"></a>00116         FD_SET( <a class="code" href="../../d8/d90/serial_8c.html#a3">FindFD</a>(port), &amp;fdset);
<a name="l00117"></a>00117         <span class="keywordflow">while</span>( 1)
<a name="l00118"></a>00118         {
<a name="l00119"></a>00119                 readsocks = select( <a class="code" href="../../d8/d90/serial_8c.html#a3">FindFD</a>(port)+ 1, &amp;fdset, NULL, NULL, &amp;tv);
<a name="l00120"></a>00120                 <span class="keywordflow">if</span>(readsocks == 0)                      
<a name="l00121"></a>00121                         <span class="keywordflow">break</span>;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123                 len2= <a class="code" href="../../d8/d90/serial_8c.html#a7">SerialBlockRead</a>( port, (<span class="keywordtype">char</span> *)buf+ len1, len- len1);
<a name="l00124"></a>00124                 len1+= len2;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126                 <a class="code" href="../../d0/d3e/mbserial_8h.html#a0">GETCLOCKMS</a>( endtime);
<a name="l00127"></a>00127                 <span class="keywordflow">if</span>( endtime &gt; starttime)                
<a name="l00128"></a>00128                 {
<a name="l00129"></a>00129                         <span class="keywordflow">if</span>( endtime-starttime &gt; <a class="code" href="../../db/da4/mbserial_8c.html#a12">MBSerialGetFrameTimeout</a>( port))
<a name="l00130"></a>00130                                 <span class="keywordflow">break</span>;
<a name="l00131"></a>00131                 }
<a name="l00132"></a>00132                 <span class="keywordflow">else</span>                                    
<a name="l00133"></a>00133                         <span class="keywordflow">if</span>( ( <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a0">U32_MAX_VALUE</a>- starttime) + endtime &gt; <a class="code" href="../../db/da4/mbserial_8c.html#a12">MBSerialGetFrameTimeout</a>( port))
<a name="l00134"></a>00134                                 <span class="keywordflow">break</span>;
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137         <span class="comment">// Check CRC</span>
<a name="l00138"></a>00138         crc= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a2">CRC16</a>( buf, len1- 2);
<a name="l00139"></a>00139         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( org_crc, buf+ len1- 2);
<a name="l00140"></a>00140         <span class="keywordflow">if</span>( crc != org_crc)
<a name="l00141"></a>00141                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         <span class="keywordflow">return</span> len1;
<a name="l00144"></a>00144 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a16_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a16_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a16_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="252,7,316,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="426,260,492,287" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="196,108,372,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="191,159,378,185" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="211,209,358,236" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="224,260,344,287" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="202,311,367,337" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a31"></a><!-- doxytag: member="mbserial.h::MBSerialReadWriteMultipleRegisters" ref="a31" args="(int port, u8 address, u16 rsreg, u16 rno, u16 *rv, u16 wsreg, u16 wno, u8 count, u16 *wv)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReadWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rv</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>wsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>wno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>wv</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Write Multiple Registers request and get response(0x17) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rsreg</em>&nbsp;</td><td>starting register number to read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rno</em>&nbsp;</td><td>number of registers ro read, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rv</em>&nbsp;</td><td>registers value slave returned </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wsreg</em>&nbsp;</td><td>starting register number to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wno</em>&nbsp;</td><td>number of registers ro write, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wv</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00778">778</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01534">MBGetResponseReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00547">MBReadWriteMultipleRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l00779"></a>00779 {
<a name="l00780"></a>00780         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00781"></a>00781         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00782"></a>00782         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ret_no;
<a name="l00783"></a>00783 
<a name="l00785"></a>00785         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a19">MBReadWriteMultipleRegisters</a>( pdu, rsreg, rno, wsreg, wno, count, wv);         <span class="comment">// make PDU</span>
<a name="l00786"></a>00786 
<a name="l00787"></a>00787         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00788"></a>00788 
<a name="l00789"></a>00789         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00790"></a>00790                 <span class="keywordflow">return</span> adu_len;
<a name="l00791"></a>00791 
<a name="l00792"></a>00792         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00793"></a>00793         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a64">MBGetResponseReadWriteMultipleRegisters</a>( pdu, (<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *)&amp;ret_no, wv);
<a name="l00794"></a>00794 
<a name="l00795"></a>00795         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00796"></a>00796                 <span class="keywordflow">return</span> ret;
<a name="l00797"></a>00797         <span class="keywordflow">if</span>( ret_no != rno*2)
<a name="l00798"></a>00798                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00799"></a>00799         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00800"></a>00800 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a31_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a31_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a31_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="398,7,488,34" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a64" shape="rect" coords="299,58,587,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a19" shape="rect" coords="339,108,547,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="334,159,552,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="636,108,780,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="640,159,776,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="654,210,763,236" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a38"></a><!-- doxytag: member="mbserial.h::MBSerialReportSlaveID" ref="a38" args="(int port, u8 address, u8 *slave_id, u8 *status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialReportSlaveID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>slave_id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Report Slave ID request and get response(0x11) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>slave_id</em>&nbsp;</td><td>buffer to store slave id </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of the device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01013">1013</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01578">MBGetResponseReportSlaveID()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00692">MBReportSlaveID()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>.<div class="fragment"><pre class="fragment"><a name="l01014"></a>01014 {
<a name="l01015"></a>01015         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01016"></a>01016         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l01017"></a>01017 
<a name="l01019"></a>01019         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a26">MBReportSlaveID</a>( pdu);
<a name="l01020"></a>01020 
<a name="l01021"></a>01021         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l01022"></a>01022 
<a name="l01023"></a>01023         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01024"></a>01024                 <span class="keywordflow">return</span> adu_len;
<a name="l01025"></a>01025 
<a name="l01026"></a>01026         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l01027"></a>01027         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a66">MBGetResponseReportSlaveID</a>( pdu, slave_id, status);
<a name="l01028"></a>01028 
<a name="l01029"></a>01029         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l01030"></a>01030                 <span class="keywordflow">return</span> ret;
<a name="l01031"></a>01031 
<a name="l01032"></a>01032         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01033"></a>01033 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a38_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a38_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a38_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="284,160,375,187" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a66" shape="rect" coords="224,211,435,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a26" shape="rect" coords="264,262,395,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="220,312,439,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="487,160,631,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="491,312,627,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="504,515,614,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="914,262,980,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="923,363,971,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="712,110,832,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="699,160,846,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="712,211,832,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="690,262,855,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="915,515,979,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="684,312,860,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="679,363,866,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="722,566,823,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="728,515,816,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a9"></a><!-- doxytag: member="mbserial.h::MBSerialSendAndWaitResponse" ref="a9" args="(int port, u8 *buf, u8 *pdu, int len, u8 address)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendAndWaitResponse           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send adu packet through serial port and wait response adu from slave 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>input buffer for receive adu from slave </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>pdu data prepare to send to slave </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>pdu length </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave id </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">343</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00031">MB_ASCII_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00077">MB_ERROR_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00027">MB_RTU_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00030">MB_RTU_PROTOCOL</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>, and <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00037">MB_SERIAL_INFO::Protocol</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00912">MBSerialDiagnostic()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00947">MBSerialGetCommEventCounter()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00981">MBSerialGetCommEventLog()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00813">MBSerialMaskWriteRegister()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00540">MBSerialReadCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00509">MBSerialReadDecreteInputs()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00880">MBSerialReadExceptionStatus()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00848">MBSerialReadFIFOQueue()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00674">MBSerialReadHoldingRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00642">MBSerialReadInputRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00778">MBSerialReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01013">MBSerialReportSlaveID()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00603">MBSerialWriteMultipleCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00740">MBSerialWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00570">MBSerialWriteSingleCoil()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00705">MBSerialWriteSingleRegister()</a>, and <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00158">serial_slave_child()</a>.<div class="fragment"><pre class="fragment"><a name="l00344"></a>00344 {
<a name="l00345"></a>00345         <span class="keywordtype">int</span> ret_len= 0;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, len, address);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349         <span class="keywordflow">if</span>( <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a> == <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a5">MB_ASCII_PROTOCOL</a>)
<a name="l00350"></a>00350                 ret_len= <a class="code" href="../../db/da4/mbserial_8c.html#a4">MBSerialReadASCII</a>( port, buf, <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>);
<a name="l00351"></a>00351         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o2">Protocol</a> == <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a4">MB_RTU_PROTOCOL</a>)
<a name="l00352"></a>00352                 ret_len= <a class="code" href="../../db/da4/mbserial_8c.html#a3">MBSerialReadRTU</a>( port, buf, <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a2">MB_RTU_ADU_MAX_LENGTH</a>);
<a name="l00353"></a>00353         <span class="keywordflow">else</span>
<a name="l00354"></a>00354                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a46">MB_ERROR_PROTOCOL</a>;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356         <span class="comment">// Multiple slave devices connect to the same serial port</span>
<a name="l00357"></a>00357         <span class="comment">// TODO: make the response data useable</span>
<a name="l00358"></a>00358         <span class="comment">//if( MBGetAddress( buf) != address)</span>
<a name="l00359"></a>00359         <span class="comment">//      return MB_ERROR_EXECPTION;</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="keywordflow">return</span> ret_len;
<a name="l00362"></a>00362 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a9_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a9_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a9_cgraph_map">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="274,159,418,186" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="278,311,414,338" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="291,463,400,490" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="727,260,794,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="736,387,784,414" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="499,7,619,34" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="486,210,632,236" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="499,159,619,186" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="476,260,642,287" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="728,564,792,591" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="471,362,647,388" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="466,412,652,439" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="508,514,610,540" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="515,463,603,490" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="700,514,820,540" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a48"></a><!-- doxytag: member="mbserial.h::MBSerialSendDiagnostic" ref="a48" args="(int port, u8 address, u16 subfunc, u16 data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Diagnostic response(0x08) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>response data of request </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01280">1280</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00924">MBResponseDiagnostic()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01281"></a>01281 {
<a name="l01282"></a>01282         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01283"></a>01283         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01284"></a>01284 
<a name="l01286"></a>01286         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a36">MBResponseDiagnostic</a>( pdu, subfunc, data);
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01289"></a>01289 
<a name="l01290"></a>01290         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01291"></a>01291                 <span class="keywordflow">return</span> adu_len;
<a name="l01292"></a>01292 
<a name="l01293"></a>01293         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01294"></a>01294 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a48_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a48_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a48_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a36" shape="rect" coords="227,52,389,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="253,103,363,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="440,71,541,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="447,133,535,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="619,7,683,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="627,57,675,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="591,108,711,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="617,159,684,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a49"></a><!-- doxytag: member="mbserial.h::MBSerialSendGetCommEventCounter" ref="a49" args="(int port, u8 address, u16 status, u16 eventcount)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendGetCommEventCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Get Comm Event Counter response(0x0B) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01306">1306</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00946">MBResponseGetCommEventCounter()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01307"></a>01307 {
<a name="l01308"></a>01308         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01309"></a>01309         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01310"></a>01310 
<a name="l01312"></a>01312         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a37">MBResponseGetCommEventCounter</a>( pdu, status, eventcount);
<a name="l01313"></a>01313 
<a name="l01314"></a>01314         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01315"></a>01315 
<a name="l01316"></a>01316         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01317"></a>01317                 <span class="keywordflow">return</span> adu_len;
<a name="l01318"></a>01318 
<a name="l01319"></a>01319         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01320"></a>01320 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a49_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a49_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a49_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a37" shape="rect" coords="308,52,553,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="376,103,485,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="603,71,704,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="609,133,697,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="781,7,845,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="789,57,837,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="753,108,873,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="780,159,847,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a50"></a><!-- doxytag: member="mbserial.h::MBSerialSendGetCommEventLog" ref="a50" args="(int port, u8 address, u8 no, u16 status, u16 eventcount, u16 messagecount, u8 *events)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendGetCommEventLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>messagecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>events</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Get Comm Event Counter response(0x0C) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of the following data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>messagecount</em>&nbsp;</td><td>counter for processed message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>events</em>&nbsp;</td><td>new events </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01335">1335</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00971">MBResponseGetCommEventLog()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01336"></a>01336 {
<a name="l01337"></a>01337         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01338"></a>01338         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01339"></a>01339 
<a name="l01341"></a>01341         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a38">MBResponseGetCommEventLog</a>( pdu, no, status, eventcount, messagecount, events);
<a name="l01342"></a>01342 
<a name="l01343"></a>01343         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01344"></a>01344 
<a name="l01345"></a>01345         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01346"></a>01346                 <span class="keywordflow">return</span> adu_len;
<a name="l01347"></a>01347 
<a name="l01348"></a>01348         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01349"></a>01349 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a50_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a50_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a50_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a38" shape="rect" coords="283,52,501,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="337,103,447,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="552,71,653,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="559,133,647,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="731,7,795,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="739,57,787,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="703,108,823,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="729,159,796,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a40"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadCoils" ref="a40" args="(int port, u8 address, u16 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Coils response(0x01) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01072">1072</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00739">MBResponseReadCoils()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01073"></a>01073 {
<a name="l01074"></a>01074         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01075"></a>01075         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01076"></a>01076 
<a name="l01078"></a>01078         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a28">MBResponseReadCoils</a>( pdu, no, value);
<a name="l01079"></a>01079 
<a name="l01080"></a>01080         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01081"></a>01081 
<a name="l01082"></a>01082         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01083"></a>01083                 <span class="keywordflow">return</span> adu_len;
<a name="l01084"></a>01084 
<a name="l01085"></a>01085         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01086"></a>01086 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a40_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a40_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a40_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a28" shape="rect" coords="226,52,388,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="252,103,362,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="438,71,539,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="444,133,532,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="616,7,680,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="624,57,672,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="588,108,708,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="615,159,682,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a39"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadDecreteInputs" ref="a39" args="(int port, u8 address, u16 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus slave function or response to master. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01046">1046</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00711">MBResponseReadDecreteInputs()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01047"></a>01047 {
<a name="l01048"></a>01048         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01049"></a>01049         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01050"></a>01050 
<a name="l01052"></a>01052         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a27">MBResponseReadDecreteInputs</a>( pdu, no, value);
<a name="l01053"></a>01053 
<a name="l01054"></a>01054         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01055"></a>01055 
<a name="l01056"></a>01056         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01057"></a>01057                 <span class="keywordflow">return</span> adu_len;
<a name="l01058"></a>01058 
<a name="l01059"></a>01059         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01060"></a>01060 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a39_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a39_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a39_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a27" shape="rect" coords="279,52,495,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="332,103,441,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="544,71,645,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="551,133,639,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="723,7,787,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="731,57,779,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="695,108,815,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="721,159,788,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a47"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadExecptionStatus" ref="a47" args="(int port, u8 address, u8 status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadExecptionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Execption Status response(0x07) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>eight exception status in one byte </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01254">1254</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00904">MBResponseReadExceptionStatus()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01255"></a>01255 {
<a name="l01256"></a>01256         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01257"></a>01257         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01258"></a>01258 
<a name="l01260"></a>01260         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a35">MBResponseReadExceptionStatus</a>( pdu, status);
<a name="l01261"></a>01261 
<a name="l01262"></a>01262         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01263"></a>01263 
<a name="l01264"></a>01264         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01265"></a>01265                 <span class="keywordflow">return</span> adu_len;
<a name="l01266"></a>01266 
<a name="l01267"></a>01267         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01268"></a>01268 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a47_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a47_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a47_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a35" shape="rect" coords="294,52,523,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="354,103,463,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="574,71,675,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="580,133,668,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="752,7,816,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="760,57,808,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="724,108,844,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="751,159,818,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a46"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadFIFOueue" ref="a46" args="(int port, u8 address, u16 no, u16 count, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadFIFOueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read FIFO Queue response(0x18) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>bytes of the following data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>FIFO value buffer size(&lt;=31) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>values of FIFO register </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01229">1229</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00880">MBResponseReadFIFOQueue()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01230"></a>01230 {
<a name="l01231"></a>01231         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01232"></a>01232         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01233"></a>01233 
<a name="l01235"></a>01235         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a34">MBResponseReadFIFOQueue</a>( pdu, no, count, value);
<a name="l01236"></a>01236 
<a name="l01237"></a>01237         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01238"></a>01238 
<a name="l01239"></a>01239         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01240"></a>01240                 <span class="keywordflow">return</span> adu_len;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01243"></a>01243 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a46_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a46_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a46_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a34" shape="rect" coords="256,52,459,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="303,103,412,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="510,71,611,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="516,133,604,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="688,7,752,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="696,57,744,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="660,108,780,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="687,159,754,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a42"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadHoldingRegisters" ref="a42" args="(int port, u8 address, u16 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Holding Registers response(0x03) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01124">1124</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00790">MBResponseReadHoldingRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01125"></a>01125 {
<a name="l01126"></a>01126         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01127"></a>01127         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01128"></a>01128 
<a name="l01130"></a>01130         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a30">MBResponseReadHoldingRegisters</a>( pdu, no, value);
<a name="l01131"></a>01131 
<a name="l01132"></a>01132         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01133"></a>01133 
<a name="l01134"></a>01134         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01135"></a>01135                 <span class="keywordflow">return</span> adu_len;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01138"></a>01138 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a42_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a42_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a42_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a30" shape="rect" coords="298,52,532,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="360,103,470,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="582,71,683,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="588,133,676,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="760,7,824,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="768,57,816,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="732,108,852,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="759,159,826,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a41"></a><!-- doxytag: member="mbserial.h::MBSerialSendReadInputRegisters" ref="a41" args="(int port, u8 address, u16 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Read Input Registers response(0x04) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01098">1098</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00767">MBResponseReadInputRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01099"></a>01099 {
<a name="l01100"></a>01100         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01101"></a>01101         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01102"></a>01102 
<a name="l01104"></a>01104         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a29">MBResponseReadInputRegisters</a>( pdu, no, value);
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01107"></a>01107 
<a name="l01108"></a>01108         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01109"></a>01109                 <span class="keywordflow">return</span> adu_len;
<a name="l01110"></a>01110 
<a name="l01111"></a>01111         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01112"></a>01112 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a41_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a41_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a41_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a29" shape="rect" coords="282,52,500,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="336,103,446,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="550,71,651,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="556,133,644,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="728,7,792,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="736,57,784,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="700,108,820,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="727,159,794,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a43"></a><!-- doxytag: member="mbserial.h::MBSerialSendWriteMultipleRegisters" ref="a43" args="(int port, u8 address, u16 startdevreg, u16 noreg)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startdevreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>noreg</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Multiple Registers response(0x10) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startdevreg</em>&nbsp;</td><td>starting register address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>noreg</em>&nbsp;</td><td>number of registers, between 1 ~ 120 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01150">1150</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00813">MBResponseWriteMultipleRegisters()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01151"></a>01151 {
<a name="l01152"></a>01152         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01153"></a>01153         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01154"></a>01154 
<a name="l01156"></a>01156         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a31">MBResponseWriteMultipleRegisters</a>( pdu, startdevreg, noreg);
<a name="l01157"></a>01157 
<a name="l01158"></a>01158         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01159"></a>01159 
<a name="l01160"></a>01160         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01161"></a>01161                 <span class="keywordflow">return</span> adu_len;
<a name="l01162"></a>01162 
<a name="l01163"></a>01163         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01164"></a>01164 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a43_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a43_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a43_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a31" shape="rect" coords="299,52,533,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="361,103,471,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="584,71,685,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="591,133,679,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="763,7,827,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="771,57,819,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="735,108,855,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="761,159,828,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a44"></a><!-- doxytag: member="mbserial.h::MBSerialSendWriteSingleCoil" ref="a44" args="(int port, u8 address, u16 coilreg, u16 onoff)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>coilreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>onoff</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Single Coil response(0x05) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>coilreg</em>&nbsp;</td><td>coil register address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>onoff</em>&nbsp;</td><td>0xFF00 for on,0x0000 for off </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01176">1176</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00835">MBResponseWriteSingleCoil()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01177"></a>01177 {
<a name="l01178"></a>01178         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01179"></a>01179         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01180"></a>01180 
<a name="l01182"></a>01182         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a32">MBResponseWriteSingleCoil</a>( pdu, coilreg, onoff);
<a name="l01183"></a>01183 
<a name="l01184"></a>01184         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01185"></a>01185 
<a name="l01186"></a>01186         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01187"></a>01187                 <span class="keywordflow">return</span> adu_len;
<a name="l01188"></a>01188 
<a name="l01189"></a>01189         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01190"></a>01190 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a44_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a44_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a44_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a32" shape="rect" coords="258,52,452,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="300,103,410,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="502,71,603,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="508,133,596,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="680,7,744,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="688,57,736,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="652,108,772,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="679,159,746,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a45"></a><!-- doxytag: member="mbserial.h::MBSerialSendWriteSingleRegister" ref="a45" args="(int port, u8 address, u16 addr, u16 value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSendWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Single Register response(0x06) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>register address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l01202">1202</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00857">MBResponseWriteSingleRegister()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l01203"></a>01203 {
<a name="l01204"></a>01204         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l01205"></a>01205         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0;
<a name="l01206"></a>01206 
<a name="l01208"></a>01208         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a33">MBResponseWriteSingleRegister</a>( pdu, addr, value);
<a name="l01209"></a>01209 
<a name="l01210"></a>01210         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a7">MBSerialWrite</a>( port, pdu, pdu_len, address);
<a name="l01211"></a>01211 
<a name="l01212"></a>01212         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l01213"></a>01213                 <span class="keywordflow">return</span> adu_len;
<a name="l01214"></a>01214 
<a name="l01215"></a>01215         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01216"></a>01216 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a45_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a45_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a45_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a33" shape="rect" coords="283,52,501,79" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="337,103,447,129" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="552,71,653,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="559,133,647,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="731,7,795,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="739,57,787,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="703,108,823,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="729,159,796,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a13"></a><!-- doxytag: member="mbserial.h::MBSerialSetCharTimeout" ref="a13" args="(int port, u32 timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MBSerialSetCharTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set char timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>new frame timeout value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00409">409</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00039">MB_SERIAL_INFO::CharTimeout</a>.<div class="fragment"><pre class="fragment"><a name="l00410"></a>00410 {
<a name="l00411"></a>00411         <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o0">CharTimeout</a>= timeout;
<a name="l00412"></a>00412 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11"></a><!-- doxytag: member="mbserial.h::MBSerialSetFrameTimeout" ref="a11" args="(int port, u32 timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MBSerialSetFrameTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set frame timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>new frame timeout value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00384">384</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00038">MB_SERIAL_INFO::FrameTimeout</a>.<div class="fragment"><pre class="fragment"><a name="l00385"></a>00385 {
<a name="l00386"></a>00386         <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o1">FrameTimeout</a>= timeout;
<a name="l00387"></a>00387 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20"></a><!-- doxytag: member="mbserial.h::MBSerialSetMode" ref="a20" args="(int port, unsigned int mode)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSetMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set serial port mode for RS232/RS422/RS485 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>mode</em>&nbsp;</td><td>serial port mode {RS232_MODE/RS485_2WIRE_MODE/RS422_MODE/RS485_4WIRE_MODE} </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>return MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00474">474</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00079">MB_ERROR_MODE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d0/d17/serial_8c-source.html#l00250">SerialSetMode()</a>.<div class="fragment"><pre class="fragment"><a name="l00475"></a>00475 {
<a name="l00476"></a>00476         <span class="keywordtype">int</span> ret= <a class="code" href="../../d8/d90/serial_8c.html#a12">SerialSetMode</a>( port, mode);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478         <span class="keywordflow">if</span>( ret &lt;= 0)
<a name="l00479"></a>00479                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a48">MB_ERROR_MODE</a>;
<a name="l00482"></a>00482 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a20_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a20_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a20_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a12" shape="rect" coords="187,7,296,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="346,7,412,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a22"></a><!-- doxytag: member="mbserial.h::MBSerialSetParam" ref="a22" args="(int port, int parity, int databits, int stopbit)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSetParam           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>parity</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>databits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>stopbit</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set serial port parameter 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parity</em>&nbsp;</td><td>parity check, 0: none, 1: odd, 2: even, 3: space </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>databits</em>&nbsp;</td><td>data bits </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stopbit</em>&nbsp;</td><td>stop bit </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>return MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00326">326</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00269">SerialSetParam()</a>.<div class="fragment"><pre class="fragment"><a name="l00327"></a>00327 {
<a name="l00328"></a>00328         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a13">SerialSetParam</a>( port, parity, databits, stopbit);
<a name="l00329"></a>00329 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a22_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a22_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a22_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a13" shape="rect" coords="195,7,309,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="359,7,425,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a21"></a><!-- doxytag: member="mbserial.h::MBSerialSetSpeed" ref="a21" args="(int port, unsigned int speed)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialSetSpeed           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>speed</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set serial speed and make changes now 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>speed</em>&nbsp;</td><td>unsigned integer for new speed </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>return SERIAL_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00492">492</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d0/d17/serial_8c-source.html#l00214">SerialSetSpeed()</a>.<div class="fragment"><pre class="fragment"><a name="l00493"></a>00493 {
<a name="l00494"></a>00494         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a11">SerialSetSpeed</a>( port, speed);
<a name="l00495"></a>00495 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a21_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a21_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a21_cgraph_map">
<area href="../../d8/d90/serial_8c.html#a11" shape="rect" coords="191,7,306,33" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="354,7,420,33" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a15"></a><!-- doxytag: member="mbserial.h::MBSerialSetTimeout" ref="a15" args="(int port, u32 timeout)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void MBSerialSetTimeout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a51">u32</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>timeout</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
set new response timeout 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout</em>&nbsp;</td><td>new response timeout value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00434">434</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d4/d13/mbserial_8h-source.html#l00040">MB_SERIAL_INFO::Timeout</a>.<div class="fragment"><pre class="fragment"><a name="l00435"></a>00435 {
<a name="l00436"></a>00436         <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].<a class="code" href="../../d8/dc6/structMB__SERIAL__INFO.html#o3">Timeout</a>= timeout;
<a name="l00437"></a>00437 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6"></a><!-- doxytag: member="mbserial.h::MBSerialWrite" ref="a6" args="(int port, u8 *pdu, int len, u8 address)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialWrite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Make ADU and sent out. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>port number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>PDU packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>PDU size </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>destination device id </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>length of data actually write, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">280</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00214">MBMakeADU()</a>, and <a class="el" href="../../d0/d17/serial_8c-source.html#l00080">SerialWrite()</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01280">MBSerialSendDiagnostic()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01306">MBSerialSendGetCommEventCounter()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01335">MBSerialSendGetCommEventLog()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01072">MBSerialSendReadCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01046">MBSerialSendReadDecreteInputs()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01254">MBSerialSendReadExecptionStatus()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01229">MBSerialSendReadFIFOueue()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01124">MBSerialSendReadHoldingRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01098">MBSerialSendReadInputRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01150">MBSerialSendWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01176">MBSerialSendWriteSingleCoil()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01202">MBSerialSendWriteSingleRegister()</a>, and <a class="el" href="../../d9/d7c/simple-mbgateway_8c-source.html#l00035">serial_master_child()</a>.<div class="fragment"><pre class="fragment"><a name="l00281"></a>00281 {
<a name="l00282"></a>00282         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>];
<a name="l00283"></a>00283         <span class="keywordtype">int</span> adu_len;
<a name="l00284"></a>00284 
<a name="l00285"></a>00285         adu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a6">MBMakeADU</a>( adu, <a class="code" href="../../db/da4/mbserial_8c.html#a0">MBSerialInfo</a>[ port].Protocol, address, pdu, len, 0);
<a name="l00286"></a>00286 
<a name="l00287"></a>00287         <span class="keywordflow">return</span> <a class="code" href="../../d8/d90/serial_8c.html#a5">SerialWrite</a>( port, (<span class="keywordtype">char</span> *)adu, adu_len);
<a name="l00288"></a>00288 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a6_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a6_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a6_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="166,71,267,97" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="172,133,260,160" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="344,7,408,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="352,57,400,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="316,108,436,135" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="343,159,410,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a26"></a><!-- doxytag: member="mbserial.h::MBSerialWriteMultipleCoils" ref="a26" args="(int port, u8 address, u16 startcoils, u16 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialWriteMultipleCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Multiple Coils request and get response(0x0F) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>return MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00603">603</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01386">MBGetResponseWriteMultipleCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00417">MBWriteMultipleCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l00604"></a>00604 {
<a name="l00605"></a>00605         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00606"></a>00606         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00607"></a>00607         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> count;
<a name="l00608"></a>00608         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_addr, ret_value;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610         count= (<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>)no/8;
<a name="l00611"></a>00611         <span class="keywordflow">if</span>( count*8 &lt; no)
<a name="l00612"></a>00612                 count++;
<a name="l00613"></a>00613 
<a name="l00615"></a>00615         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a14">MBWriteMultipleCoils</a>( pdu, startcoils, no, count, value);
<a name="l00616"></a>00616 
<a name="l00617"></a>00617         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00618"></a>00618 
<a name="l00619"></a>00619         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00620"></a>00620                 <span class="keywordflow">return</span> adu_len;
<a name="l00621"></a>00621 
<a name="l00622"></a>00622         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00623"></a>00623         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a57">MBGetResponseWriteMultipleCoils</a>( pdu, &amp;ret_addr, &amp;ret_value);
<a name="l00624"></a>00624         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00625"></a>00625                 <span class="keywordflow">return</span> ret;
<a name="l00626"></a>00626         <span class="keywordflow">if</span>( ( ret_addr != startcoils) || ( ret_value != no))
<a name="l00627"></a>00627                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00628"></a>00628         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00629"></a>00629 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a26_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a26_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a26_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="312,211,403,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a57" shape="rect" coords="241,262,473,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="248,312,467,339" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a14" shape="rect" coords="283,363,432,390" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="521,160,665,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="525,312,661,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="539,515,648,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="948,262,1015,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="957,363,1005,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="747,110,867,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="733,160,880,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="747,211,867,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="724,262,889,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="949,515,1013,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="719,312,895,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="713,363,900,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="756,566,857,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="763,515,851,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a30"></a><!-- doxytag: member="mbserial.h::MBSerialWriteMultipleRegisters" ref="a30" args="(int port, u8 address, u16 startdevreg, u16 noreg, u8 count, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startdevreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>noreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Multiple Registers request and get response(0x10) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startdevreg</em>&nbsp;</td><td>starting register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>noreg</em>&nbsp;</td><td>number of registers, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>register status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00740">740</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01346">MBGetResponseWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00515">MBWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00741"></a>00741 {
<a name="l00742"></a>00742         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00743"></a>00743         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00744"></a>00744         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_addr, ret_value;
<a name="l00745"></a>00745 
<a name="l00747"></a>00747         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a18">MBWriteMultipleRegisters</a>( pdu, startdevreg, noreg, count, value);              <span class="comment">// make PDU</span>
<a name="l00748"></a>00748 
<a name="l00749"></a>00749         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00752"></a>00752                 <span class="keywordflow">return</span> adu_len;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00755"></a>00755         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a55">MBGetResponseWriteMultipleRegisters</a>( pdu, &amp;ret_addr, &amp;ret_value);
<a name="l00756"></a>00756         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00757"></a>00757                 <span class="keywordflow">return</span> ret;
<a name="l00758"></a>00758         <span class="keywordflow">if</span>( ( ret_addr != startdevreg) || ( ret_value != noreg))
<a name="l00759"></a>00759                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00760"></a>00760         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00761"></a>00761 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a30_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a30_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a30_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="352,7,443,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a55" shape="rect" coords="268,57,527,84" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="288,108,507,135" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a18" shape="rect" coords="309,159,485,185" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="575,57,719,84" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="579,108,715,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="592,159,701,185" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a25"></a><!-- doxytag: member="mbserial.h::MBSerialWriteSingleCoil" ref="a25" args="(int port, u8 address, u16 coilreg, u16 onoff)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>coilreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>onoff</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Single Coil request and get response(0x05) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>coilreg</em>&nbsp;</td><td>coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>onoff</em>&nbsp;</td><td>0xFF00 for on,0x0000 for off. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>return MB_OK for success, on error return error code</dd></dl>
&lt; make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00570">570</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01366">MBGetResponseWriteSingleCoil()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00393">MBWriteSingleCoil()</a>.<div class="fragment"><pre class="fragment"><a name="l00571"></a>00571 {
<a name="l00572"></a>00572         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00573"></a>00573         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00574"></a>00574         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_addr, ret_value;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a13">MBWriteSingleCoil</a>( pdu, coilreg, onoff);       
<a name="l00577"></a>00577 
<a name="l00578"></a>00578         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00579"></a>00579 
<a name="l00580"></a>00580         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00581"></a>00581                 <span class="keywordflow">return</span> adu_len;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00584"></a>00584         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a56">MBGetResponseWriteSingleCoil</a>( pdu, &amp;ret_addr, &amp;ret_value);
<a name="l00585"></a>00585         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00586"></a>00586                 <span class="keywordflow">return</span> ret;
<a name="l00587"></a>00587         <span class="keywordflow">if</span>( ( ret_addr != coilreg) || ( ret_value != onoff))
<a name="l00588"></a>00588                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00589"></a>00589         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00590"></a>00590 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a25_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a25_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a25_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="289,211,380,238" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a56" shape="rect" coords="227,262,443,288" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="225,312,444,339" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a13" shape="rect" coords="268,363,401,390" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="492,160,636,187" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="496,312,632,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="509,515,619,542" alt="">
<area href="../../d8/d90/serial_8c.html#a3" shape="rect" coords="919,262,985,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="928,363,976,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a4" shape="rect" coords="717,110,837,136" alt="">
<area href="../../db/da4/mbserial_8c.html#a16" shape="rect" coords="704,160,851,187" alt="">
<area href="../../d8/d90/serial_8c.html#a7" shape="rect" coords="717,211,837,238" alt="">
<area href="../../d8/d90/serial_8c.html#a9" shape="rect" coords="695,262,860,288" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="920,515,984,542" alt="">
<area href="../../db/da4/mbserial_8c.html#a14" shape="rect" coords="689,312,865,339" alt="">
<area href="../../db/da4/mbserial_8c.html#a12" shape="rect" coords="684,363,871,390" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a6" shape="rect" coords="727,566,828,592" alt="">
<area href="../../d8/d90/serial_8c.html#a5" shape="rect" coords="733,515,821,542" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a29"></a><!-- doxytag: member="mbserial.h::MBSerialWriteSingleRegister" ref="a29" args="(int port, u8 address, u16 devicereg, u16 value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBSerialWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>devicereg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
send Write Single Register request and get response(0x06) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>port</em>&nbsp;</td><td>which port to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>slave device address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>devicereg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>register status slave returned </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>
make PDU 
<p>
Definition at line <a class="el" href="../../de/d42/mbserial_8c-source.html#l00705">705</a> of file <a class="el" href="../../de/d42/mbserial_8c-source.html">mbserial.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00034">MAX_BUFFER_SIZE</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00073">MB_ERROR_EXECPTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">MBGetPDU()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01406">MBGetResponseWriteSingleRegister()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00343">MBSerialSendAndWaitResponse()</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00491">MBWriteSingleRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l00706"></a>00706 {
<a name="l00707"></a>00707         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> adu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>], pdu[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a7">MAX_BUFFER_SIZE</a>];
<a name="l00708"></a>00708         <span class="keywordtype">int</span> pdu_len= 0, adu_len= 0, ret= 0;
<a name="l00709"></a>00709         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ret_addr, ret_value;
<a name="l00710"></a>00710 
<a name="l00712"></a>00712         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a17">MBWriteSingleRegister</a>( pdu, devicereg, value);
<a name="l00713"></a>00713 
<a name="l00714"></a>00714         adu_len= <a class="code" href="../../db/da4/mbserial_8c.html#a11">MBSerialSendAndWaitResponse</a>( port, adu, pdu, pdu_len, address);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716         <span class="keywordflow">if</span>( adu_len &lt; 0)
<a name="l00717"></a>00717                 <span class="keywordflow">return</span> adu_len;
<a name="l00718"></a>00718 
<a name="l00719"></a>00719         pdu_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a7">MBGetPDU</a>( pdu, adu, adu_len);
<a name="l00720"></a>00720         ret= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a58">MBGetResponseWriteSingleRegister</a>( pdu, &amp;ret_addr, &amp;ret_value);
<a name="l00721"></a>00721         <span class="keywordflow">if</span>( ret &lt; 0)
<a name="l00722"></a>00722                 <span class="keywordflow">return</span> ret;
<a name="l00723"></a>00723         <span class="keywordflow">if</span>( ( ret_addr != devicereg) || ( ret_value != value))
<a name="l00724"></a>00724                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a42">MB_ERROR_EXECPTION</a>;
<a name="l00725"></a>00725         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l00726"></a>00726 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d0/d3e/mbserial_8h_a29_cgraph.png" border="0" usemap="#d0/d3e/mbserial_8h_a29_cgraph_map" alt=""></center>
<map name="d0/d3e/mbserial_8h_a29_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a7" shape="rect" coords="328,7,419,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a58" shape="rect" coords="252,57,495,84" alt="">
<area href="../../db/da4/mbserial_8c.html#a11" shape="rect" coords="264,108,483,135" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a17" shape="rect" coords="293,159,453,185" alt="">
<area href="../../db/da4/mbserial_8c.html#a4" shape="rect" coords="543,57,687,84" alt="">
<area href="../../db/da4/mbserial_8c.html#a3" shape="rect" coords="547,108,683,135" alt="">
<area href="../../db/da4/mbserial_8c.html#a7" shape="rect" coords="560,159,669,185" alt="">
</map>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Fri Sep 9 20:27:45 2005 for Example Modbus Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
