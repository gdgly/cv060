<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Example Modbus Library: C:/modbus/library/modbus_utils.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.4 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="../../annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="../../dirs.html">Directories</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="../../globals.html">Globals</a></div>
<div class="nav">
<a class="el" href="../../dir_000000.html">modbus</a>&nbsp;&raquo&nbsp;<a class="el" href="../../dir_000001.html">library</a></div>
<h1>modbus_utils.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Example modbus utilities header file. 
<p>
This file contains much modbus utility functions. It helps to merge modbus function code and data to a PDU and split PDU to modbus function code and data. We split one request and response into four functions, for example if modbus master sends Read Coils request to slave and gets slave's response, we might have to use these four functions.<p>
Modbus Master Modbus Slave 1. <a class="el" href="../../d4/d81/modbus__utils_8c.html#a12">MBReadCoils()</a> ----&gt; 2. <a class="el" href="../../d4/d81/modbus__utils_8c.html#a40">MBGetReadCoils()</a> 4. <a class="el" href="../../d4/d81/modbus__utils_8c.html#a52">MBGetResponseReadCoils()</a> &lt;---- 3. MBResponseReadCoils<p>
History: Date Author Comment 08-01-2005 AceLan Kao. Create it.<p>
<dl compact><dt><b>Author:</b></dt><dd>AceLan Kao.(<a href="mailto:acelan_kao@moxa.com.tw">acelan_kao@moxa.com.tw</a>)</dd></dl>

<p>
Definition in file <a class="el" href="../../d1/d17/modbus__utils_8h-source.html">modbus_utils.h</a>.
<p>

<p>
This graph shows which files directly or indirectly include this file:<p><center><img src="../../d2/d85/modbus__utils_8h__dep__incl.png" border="0" usemap="#C:/modbus/library/modbus_utils.hdep_map" alt=""></center>
<map name="C:/modbus/library/modbus_utils.hdep_map">
<area href="../../d0/d3e/mbserial_8h.html" shape="rect" coords="291,57,483,84" alt="">
<area href="../../db/da4/mbserial_8c.html" shape="rect" coords="613,7,805,33" alt="">
<area href="../../da/d19/mbtcp_8h.html" shape="rect" coords="297,108,476,135" alt="">
<area href="../../d4/d81/modbus__utils_8c.html" shape="rect" coords="277,159,496,185" alt="">
<area href="../../d9/d00/simple-mbgateway_8c.html" shape="rect" coords="545,57,873,84" alt="">
<area href="../../d2/dc1/mbtcp_8c.html" shape="rect" coords="620,108,799,135" alt="">
</map>

<p>
<a href="../../d1/d17/modbus__utils_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>(var, buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get 16 bits data from buf  <a href="#a0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>(buf, var)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">put 16 bits data to buf  <a href="#a1"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a2">CRC16</a> (const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate the CRC16 value of the input data  <a href="#a2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a3">LRC</a> (const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calculate the checksum value of the input data  <a href="#a3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a4">MBASCIIToData</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *data, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse ASCII mode data to binary data  <a href="#a4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a5">MBDataToASCII</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *data, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse binary data to ASCII mode data  <a href="#a5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a23">MBDiagnostic</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x08  <a href="#a23"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a9">MBGetAddress</a> (const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *adu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get device address from ADU  <a href="#a9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a24">MBGetCommEventCounter</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x0B  <a href="#a24"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a25">MBGetCommEventLog</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x0C  <a href="#a25"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a50">MBGetDiagnostic</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Diagnostic function(0x08)  <a href="#a50"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a10">MBGetFunctionCode</a> (const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get function code from PDU  <a href="#a10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a48">MBGetMaskWriteRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *reg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *andmask, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *ormask)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Mask Write Register function(0x16)  <a href="#a48"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a7">MBGetPDU</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *adu, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">get PDU part from ADU data  <a href="#a7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a40">MBGetReadCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Read Coils function(0x01)  <a href="#a40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a39">MBGetReadDecreteInputs</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startdec, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus get request value from PDU.  <a href="#a39"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a49">MBGetReadFIFOQueue</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *FIFOAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Read FIFO Queue function(0x18)  <a href="#a49"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a44">MBGetReadHoldingRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Read Holding Registers function(0x03)  <a href="#a44"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a43">MBGetReadInputRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Read Input Registers function(0x04)  <a href="#a43"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a47">MBGetReadWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *rsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *rno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *wsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *wno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *wv)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Read Write Multiple Registers function(0x17)  <a href="#a47"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a61">MBGetResponseDiagnostic</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Diagnostic request(0x08)  <a href="#a61"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a62">MBGetResponseGetCommEventCounter</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *eventcount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Get Comm Event Counter request(0x0B)  <a href="#a62"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a63">MBGetResponseGetCommEventLog</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *eventcount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *messagecount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *events)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Get Comm Event Counter request(0x0C)  <a href="#a63"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a65">MBGetResponseMaskWriteRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *reg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *andmask, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *ormask)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Mask Write Register function(0x16)  <a href="#a65"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a52">MBGetResponseReadCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Response Read Coils request(0x01)  <a href="#a52"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a51">MBGetResponseReadDecreteInputs</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus get response value from PDU.  <a href="#a51"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a60">MBGetResponseReadExecptionStatus</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a59">MBGetResponseReadFIFOueue</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a54">MBGetResponseReadHoldingRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Read Holding Registers request(0x03)  <a href="#a54"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a53">MBGetResponseReadInputRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Read Input Registers request(0x04)  <a href="#a53"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a64">MBGetResponseReadWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Response Read Coils request(0x17)  <a href="#a64"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a66">MBGetResponseReportSlaveID</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *slave_id, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *status)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Report Slave ID function(0x16)  <a href="#a66"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a57">MBGetResponseWriteMultipleCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Write Multiple Coil request(0x0F)  <a href="#a57"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a55">MBGetResponseWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Write Multiple Registers request(0x10)  <a href="#a55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a56">MBGetResponseWriteSingleCoil</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Write Single Coil request(0x05)  <a href="#a56"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a58">MBGetResponseWriteSingleRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *address, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse response PDU packet of Write Single Register request(0x06)  <a href="#a58"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a42">MBGetWriteMultipleCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Write Multiple Coils function(0x0F)  <a href="#a42"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a46">MBGetWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Write Multiple Registers function(0x10)  <a href="#a46"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a41">MBGetWriteSingleCoil</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *coilreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *onoff)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Write Single Coil function(0x05)  <a href="#a41"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a45">MBGetWriteSingleRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *devicereg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">parse PDU packet of Write Single Register function(0x06)  <a href="#a45"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a6">MBMakeADU</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, int protocol, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> address, const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *pdu, int len, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> tid)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modbus utilities functions.  <a href="#a6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a8">MBMakePDU</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> function, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *data, int len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">assemble function code and data to ADU  <a href="#a8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a20">MBMaskWriteRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> reg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> andmask, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> ormask)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x16  <a href="#a20"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a12">MBReadCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x01  <a href="#a12"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a11">MBReadDecreteInputs</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startdec, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Master function 0x02.  <a href="#a11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a22">MBReadExceptionStatus</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x07  <a href="#a22"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a21">MBReadFIFOQueue</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> FIFOAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x18  <a href="#a21"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a16">MBReadHoldingRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x03  <a href="#a16"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a15">MBReadInputRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x04  <a href="#a15"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a19">MBReadWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> rsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> rno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> wsreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> wno, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *wv)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x17  <a href="#a19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a26">MBReportSlaveID</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x11  <a href="#a26"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a36">MBResponseDiagnostic</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> subfunc, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Diagnostic request(0x08)  <a href="#a36"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a37">MBResponseGetCommEventCounter</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> eventcount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Get Comm Event Counter request(0x0B)  <a href="#a37"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a38">MBResponseGetCommEventLog</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> status, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> eventcount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> messagecount, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *events)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Get Comm Event Counter request(0x0C)  <a href="#a38"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a28">MBResponseReadCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Response Read Coils request(0x01)  <a href="#a28"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a27">MBResponseReadDecreteInputs</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Response function.  <a href="#a27"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a35">MBResponseReadExecptionStatus</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> status)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a34">MBResponseReadFIFOueue</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a30">MBResponseReadHoldingRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Read Holding Registers request(0x03)  <a href="#a30"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a29">MBResponseReadInputRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Read Input Registers request(0x04)  <a href="#a29"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a31">MBResponseWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startdevreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Write Multiple Registers request(0x10)  <a href="#a31"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a32">MBResponseWriteSingleCoil</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> coilreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> onoff)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Write Single Coil request(0x05)  <a href="#a32"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a33">MBResponseWriteSingleRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> reg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">make response PDU packet of Write Single Register request(0x06)  <a href="#a33"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a14">MBWriteMultipleCoils</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startcoils, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> no, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x0F  <a href="#a14"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a18">MBWriteMultipleRegisters</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> startreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> noreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> count, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *no)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x10  <a href="#a18"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a13">MBWriteSingleCoil</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> coilreg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> onoff)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x05  <a href="#a13"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d8e/modbus__utils_8h.html#a17">MBWriteSingleRegister</a> (<a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *buf, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> devicereg, <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> value)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">0x06  <a href="#a17"></a><br></td></tr>
</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0"></a><!-- doxytag: member="modbus_utils.h::GETU16" ref="a0" args="(var, buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define GETU16          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">var,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>buf&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                               \
                (var) = (*(buf) &lt;&lt; 8) &amp; 0xFF00;         \
                (var) |= (*((buf)+1) &amp; 0xFF);           \
        }
</pre></div>get 16 bits data from buf 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>var</em>&nbsp;</td><td>a 16 bits variable </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a pointer to data buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">37</a> of file <a class="el" href="../../d1/d17/modbus__utils_8h-source.html">modbus_utils.h</a>.
<p>
Referenced by <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01237">MBGetDiagnostic()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01198">MBGetMaskWriteRegister()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01020">MBGetReadCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01000">MBGetReadDecreteInputs()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01218">MBGetReadFIFOQueue()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01100">MBGetReadHoldingRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01080">MBGetReadInputRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01171">MBGetReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01467">MBGetResponseDiagnostic()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01487">MBGetResponseGetCommEventCounter()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01509">MBGetResponseGetCommEventLog()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01557">MBGetResponseMaskWriteRegister()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01426">MBGetResponseReadFIFOQueue()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01324">MBGetResponseReadHoldingRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01302">MBGetResponseReadInputRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01534">MBGetResponseReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01386">MBGetResponseWriteMultipleCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01346">MBGetResponseWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01366">MBGetResponseWriteSingleCoil()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01406">MBGetResponseWriteSingleRegister()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01060">MBGetWriteMultipleCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01142">MBGetWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01040">MBGetWriteSingleCoil()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01120">MBGetWriteSingleRegister()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00148">MBTCPGetMBAP()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1"></a><!-- doxytag: member="modbus_utils.h::PUTU16" ref="a1" args="(buf, var)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">#define PUTU16          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">buf,         <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>var&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><div class="fragment"><pre class="fragment">{                               \
                (*(buf)) = ((var) &gt;&gt; 8);                \
                *((buf)+1) = ((var) &amp; 0xFF);            \
        }
</pre></div>put 16 bits data to buf 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>a pointer to data buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>var</em>&nbsp;</td><td>a 16 bits variable </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">49</a> of file <a class="el" href="../../d1/d17/modbus__utils_8h-source.html">modbus_utils.h</a>.
<p>
Referenced by <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00640">MBDiagnostic()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00578">MBMaskWriteRegister()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00371">MBReadCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00349">MBReadDecreteInputs()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00601">MBReadFIFOQueue()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00469">MBReadHoldingRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00447">MBReadInputRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00547">MBReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00924">MBResponseDiagnostic()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00946">MBResponseGetCommEventCounter()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00971">MBResponseGetCommEventLog()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00739">MBResponseReadCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00711">MBResponseReadDecreteInputs()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00880">MBResponseReadFIFOQueue()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00790">MBResponseReadHoldingRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00767">MBResponseReadInputRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00813">MBResponseWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00835">MBResponseWriteSingleCoil()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00857">MBResponseWriteSingleRegister()</a>, <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00186">MBTCPWriteMBAP()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00417">MBWriteMultipleCoils()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00515">MBWriteMultipleRegisters()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00393">MBWriteSingleCoil()</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00491">MBWriteSingleRegister()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2"></a><!-- doxytag: member="modbus_utils.h::CRC16" ref="a2" args="(const u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> CRC16           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
calculate the CRC16 value of the input data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>input data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the input data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>CRC16 value of the input data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00079">79</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00031">CRCHi</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00051">CRCLo</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00066">MB_ERROR_PARAMETER</a>.
<p>
Referenced by <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00214">MBMakeADU()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00090">MBSerialReadRTU()</a>.<div class="fragment"><pre class="fragment"><a name="l00080"></a>00080 {
<a name="l00081"></a>00081         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   hi=0xFF;
<a name="l00082"></a>00082         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   lo=0xFF;
<a name="l00083"></a>00083         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>  index;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="keywordflow">if</span> ( buf == 0 || len &lt;= 0 )
<a name="l00086"></a>00086                 <span class="keywordflow">return</span>(<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a35">MB_ERROR_PARAMETER</a>);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088         <span class="keywordflow">while</span> ( len-- ) {
<a name="l00089"></a>00089                 index = lo ^ (<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>)*buf++;
<a name="l00090"></a>00090                 lo = hi ^ <a class="code" href="../../d4/d81/modbus__utils_8c.html#a0">CRCHi</a>[index];
<a name="l00091"></a>00091                 hi = <a class="code" href="../../d4/d81/modbus__utils_8c.html#a1">CRCLo</a>[index];
<a name="l00092"></a>00092         }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094         index = lo &lt;&lt; 8;
<a name="l00095"></a>00095         index |= hi;
<a name="l00096"></a>00096         <span class="keywordflow">return</span>(index);
<a name="l00097"></a>00097 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3"></a><!-- doxytag: member="modbus_utils.h::LRC" ref="a3" args="(const u8 *buf, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> LRC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
calculate the checksum value of the input data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>input data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the input data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>checksum value of the input data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00107">107</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00066">MB_ERROR_PARAMETER</a>.
<p>
Referenced by <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00214">MBMakeADU()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>.<div class="fragment"><pre class="fragment"><a name="l00108"></a>00108 {
<a name="l00109"></a>00109         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   ch=0;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111         <span class="keywordflow">if</span> ( len &lt;= 0 || buf == 0 )
<a name="l00112"></a>00112                 <span class="keywordflow">return</span>(<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a35">MB_ERROR_PARAMETER</a>);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <span class="keywordflow">while</span> ( len-- )
<a name="l00115"></a>00115                 ch += (<span class="keywordtype">unsigned</span> char)*buf++;
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="keywordflow">return</span>(ch);
<a name="l00118"></a>00118 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a4"></a><!-- doxytag: member="modbus_utils.h::MBASCIIToData" ref="a4" args="(u8 *buf, const u8 *data, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBASCIIToData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse ASCII mode data to binary data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>input ASCII data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the input data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of data after parse. On error return error code</dd></dl>
This function read the PDU part as input, parse it as Modbus ASCII protocol, and produce the binary data.
<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00132">132</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00064">MB_ERROR_FORMAT</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00065">MB_ERROR_LENGTH</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00158">MBSerialReadASCII()</a>.<div class="fragment"><pre class="fragment"><a name="l00133"></a>00133 {
<a name="l00134"></a>00134         <span class="keywordtype">int</span> i= 0;
<a name="l00135"></a>00135         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ch1, ch2;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137         <span class="comment">/* to do length error check */</span>
<a name="l00138"></a>00138         <span class="keywordflow">if</span> ( len &amp; 1 )
<a name="l00139"></a>00139                 <span class="keywordflow">return</span>( <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a34">MB_ERROR_LENGTH</a>);
<a name="l00140"></a>00140         <span class="keywordflow">if</span> ( len &lt;=1 || len &gt;= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a> )
<a name="l00141"></a>00141                 <span class="keywordflow">return</span>( <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a34">MB_ERROR_LENGTH</a>);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143         <span class="keywordflow">for</span> ( i=0; i&lt;len; i+=2 )
<a name="l00144"></a>00144         {
<a name="l00145"></a>00145                 ch2 = 0;
<a name="l00146"></a>00146                 ch1 = *data++;
<a name="l00147"></a>00147                 <span class="keywordflow">if</span> ( ch1 &gt;= <span class="charliteral">'0'</span> &amp;&amp; ch1 &lt;= <span class="charliteral">'9'</span> )
<a name="l00148"></a>00148                         ch1 -= <span class="charliteral">'0'</span>;
<a name="l00149"></a>00149                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ch1 &gt;= <span class="charliteral">'A'</span> &amp;&amp; ch1 &lt;= <span class="charliteral">'F'</span> )
<a name="l00150"></a>00150                         ch1 = ch1 - <span class="charliteral">'A'</span> + 10;
<a name="l00151"></a>00151                 <span class="keywordflow">else</span>
<a name="l00152"></a>00152                         <span class="keywordflow">return</span>(<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>);
<a name="l00153"></a>00153                 ch2 = ch1 &lt;&lt; 4;
<a name="l00154"></a>00154                 ch1 = *data++;
<a name="l00155"></a>00155                 <span class="keywordflow">if</span> ( ch1 &gt;= <span class="charliteral">'0'</span> &amp;&amp; ch1 &lt;= <span class="charliteral">'9'</span> )
<a name="l00156"></a>00156                         ch1 -= <span class="charliteral">'0'</span>;
<a name="l00157"></a>00157                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ch1 &gt;= <span class="charliteral">'A'</span> &amp;&amp; ch1 &lt;= <span class="charliteral">'F'</span> )
<a name="l00158"></a>00158                         ch1 = ch1 - <span class="charliteral">'A'</span> + 10;
<a name="l00159"></a>00159                 <span class="keywordflow">else</span>
<a name="l00160"></a>00160                         <span class="keywordflow">return</span>(<a class="code" href="../../d7/dcc/modbus__defs_8h.html#a33">MB_ERROR_FORMAT</a>);
<a name="l00161"></a>00161                 ch2 |= ch1;
<a name="l00162"></a>00162                 *buf++ = ch2;
<a name="l00163"></a>00163         }
<a name="l00164"></a>00164 
<a name="l00165"></a>00165         <span class="keywordflow">return</span>(len/2);
<a name="l00166"></a>00166 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a5"></a><!-- doxytag: member="modbus_utils.h::MBDataToASCII" ref="a5" args="(u8 *buf, const u8 *data, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBDataToASCII           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse binary data to ASCII mode data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>input binary data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the input data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of data after parse. On error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00177">177</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
Referenced by <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00214">MBMakeADU()</a>.<div class="fragment"><pre class="fragment"><a name="l00178"></a>00178 {
<a name="l00179"></a>00179         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> lrc= 0;
<a name="l00180"></a>00180         <span class="keywordtype">int</span> i= 0, j= 0;
<a name="l00181"></a>00181 
<a name="l00182"></a>00182         <span class="keywordflow">for</span>( i= 0; i&lt; len; i++)
<a name="l00183"></a>00183         {
<a name="l00184"></a>00184                 <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> ch= ((data[ i] &amp; 0xF0) &gt;&gt; 4);
<a name="l00185"></a>00185                 <span class="keywordflow">if</span>( ch &gt;= 0 &amp;&amp; ch &lt;= 9)
<a name="l00186"></a>00186                         ch+= <span class="charliteral">'0'</span>;
<a name="l00187"></a>00187                 <span class="keywordflow">else</span>
<a name="l00188"></a>00188                         ch+= (<span class="charliteral">'A'</span>- 10);
<a name="l00189"></a>00189                 buf[ j++]= ch;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191                 ch= (data[ i] &amp; 0x0F);
<a name="l00192"></a>00192                 <span class="keywordflow">if</span>( ch &gt;= 0 &amp;&amp; ch &lt;= 9)
<a name="l00193"></a>00193                         ch+= <span class="charliteral">'0'</span>;
<a name="l00194"></a>00194                 <span class="keywordflow">else</span>
<a name="l00195"></a>00195                         ch+= (<span class="charliteral">'A'</span>-10);
<a name="l00196"></a>00196                 buf[ j++]= ch;
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198 
<a name="l00199"></a>00199         <span class="keywordflow">return</span> j;
<a name="l00200"></a>00200 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23"></a><!-- doxytag: member="modbus_utils.h::MBDiagnostic" ref="a23" args="(u8 *buf, u16 subfunc, u16 data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x08 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to be sent to slave device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00640">640</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00053">MBF_DIAGNOSTIC</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00912">MBSerialDiagnostic()</a>.<div class="fragment"><pre class="fragment"><a name="l00641"></a>00641 {
<a name="l00642"></a>00642         <span class="keywordtype">int</span> len= 0;
<a name="l00643"></a>00643         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a24">MBF_DIAGNOSTIC</a>;
<a name="l00644"></a>00644         len++;
<a name="l00645"></a>00645         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, subfunc);             <span class="comment">// don't put ++ in the macro</span>
<a name="l00646"></a>00646         len+= 2;
<a name="l00647"></a>00647         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, data);                <span class="comment">// all data of subfunc is 16bits long</span>
<a name="l00648"></a>00648         len+= 2;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         <span class="keywordflow">return</span> len;
<a name="l00651"></a>00651 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a9"></a><!-- doxytag: member="modbus_utils.h::MBGetAddress" ref="a9" args="(const u8 *adu)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> MBGetAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>adu</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get device address from ADU 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>adu</em>&nbsp;</td><td>ADU data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00321">321</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00446">MBSerialGetAddress()</a>.<div class="fragment"><pre class="fragment"><a name="l00322"></a>00322 {
<a name="l00323"></a>00323         <span class="keywordflow">return</span> adu[ 0];
<a name="l00324"></a>00324 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a24"></a><!-- doxytag: member="modbus_utils.h::MBGetCommEventCounter" ref="a24" args="(u8 *buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetCommEventCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>buf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x0B 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00660">660</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00054">MBF_GET_COMM_EVENT_COUNTER</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00947">MBSerialGetCommEventCounter()</a>.<div class="fragment"><pre class="fragment"><a name="l00661"></a>00661 {
<a name="l00662"></a>00662         <span class="keywordtype">int</span> len= 0;
<a name="l00663"></a>00663         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a25">MBF_GET_COMM_EVENT_COUNTER</a>;
<a name="l00664"></a>00664         len++;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666         <span class="keywordflow">return</span> len;
<a name="l00667"></a>00667 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a25"></a><!-- doxytag: member="modbus_utils.h::MBGetCommEventLog" ref="a25" args="(u8 *buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetCommEventLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>buf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x0C 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00676">676</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00055">MBF_GET_COMM_EVENT_LOG</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00981">MBSerialGetCommEventLog()</a>.<div class="fragment"><pre class="fragment"><a name="l00677"></a>00677 {
<a name="l00678"></a>00678         <span class="keywordtype">int</span> len= 0;
<a name="l00679"></a>00679         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a26">MBF_GET_COMM_EVENT_LOG</a>;
<a name="l00680"></a>00680         len++;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         <span class="keywordflow">return</span> len;
<a name="l00683"></a>00683 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a50"></a><!-- doxytag: member="modbus_utils.h::MBGetDiagnostic" ref="a50" args="(u8 *pdu, u16 *subfunc, u16 *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Diagnostic function(0x08) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data to be sent to slave device </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01237">1237</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00053">MBF_DIAGNOSTIC</a>.<div class="fragment"><pre class="fragment"><a name="l01238"></a>01238 {
<a name="l01239"></a>01239         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a24">MBF_DIAGNOSTIC</a>)
<a name="l01240"></a>01240                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *subfunc, pdu+ 1);
<a name="l01243"></a>01243         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *data, pdu+ 3);
<a name="l01244"></a>01244 
<a name="l01245"></a>01245         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01246"></a>01246 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a10"></a><!-- doxytag: member="modbus_utils.h::MBGetFunctionCode" ref="a10" args="(const u8 *pdu)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> MBGetFunctionCode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pdu</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get function code from PDU 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>PDU data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>none</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00333">333</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.<div class="fragment"><pre class="fragment"><a name="l00334"></a>00334 {
<a name="l00335"></a>00335         <span class="keywordflow">return</span> pdu[ 0];
<a name="l00336"></a>00336 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48"></a><!-- doxytag: member="modbus_utils.h::MBGetMaskWriteRegister" ref="a48" args="(u8 *pdu, u16 *reg, u16 *andmask, u16 *ormask)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetMaskWriteRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>andmask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ormask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Mask Write Register function(0x16) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>andmask</em>&nbsp;</td><td>and mask </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ormask</em>&nbsp;</td><td>or mask </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01198">1198</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00047">MBF_MASK_WRITE_REGISTER</a>.<div class="fragment"><pre class="fragment"><a name="l01199"></a>01199 {
<a name="l01200"></a>01200         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a18">MBF_MASK_WRITE_REGISTER</a>)
<a name="l01201"></a>01201                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01202"></a>01202 
<a name="l01203"></a>01203         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *reg, pdu+ 1);
<a name="l01204"></a>01204         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *andmask, pdu+ 3);
<a name="l01205"></a>01205         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *ormask, pdu+ 5);
<a name="l01206"></a>01206 
<a name="l01207"></a>01207         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01208"></a>01208 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a7"></a><!-- doxytag: member="modbus_utils.h::MBGetPDU" ref="a7" args="(u8 *buf, u8 *adu, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetPDU           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>adu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get PDU part from ADU data 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>adu</em>&nbsp;</td><td>ADU data with error check code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the adu data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00283">283</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00912">MBSerialDiagnostic()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00947">MBSerialGetCommEventCounter()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00981">MBSerialGetCommEventLog()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00460">MBSerialGetPDU()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00813">MBSerialMaskWriteRegister()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00540">MBSerialReadCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00509">MBSerialReadDecreteInputs()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00880">MBSerialReadExceptionStatus()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00848">MBSerialReadFIFOQueue()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00674">MBSerialReadHoldingRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00642">MBSerialReadInputRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00778">MBSerialReadWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l01013">MBSerialReportSlaveID()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00603">MBSerialWriteMultipleCoils()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00740">MBSerialWriteMultipleRegisters()</a>, <a class="el" href="../../de/d42/mbserial_8c-source.html#l00570">MBSerialWriteSingleCoil()</a>, and <a class="el" href="../../de/d42/mbserial_8c-source.html#l00705">MBSerialWriteSingleRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l00284"></a>00284 {
<a name="l00285"></a>00285         <span class="keywordtype">int</span> minus= 2;
<a name="l00286"></a>00286         <span class="keywordflow">if</span>( adu[ 0] == <span class="charliteral">':'</span>)
<a name="l00287"></a>00287                 minus= 1;
<a name="l00288"></a>00288         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)(adu+1), (<span class="keywordtype">char</span> *)buf, len- 1- minus);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         <span class="keywordflow">return</span> len- 1- minus;
<a name="l00291"></a>00291 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a40"></a><!-- doxytag: member="modbus_utils.h::MBGetReadCoils" ref="a40" args="(u8 *pdu, u16 *startcoils, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Read Coils function(0x01) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01020">1020</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00039">MBF_READ_COILS</a>.<div class="fragment"><pre class="fragment"><a name="l01021"></a>01021 {
<a name="l01022"></a>01022         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a10">MBF_READ_COILS</a>)
<a name="l01023"></a>01023                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01024"></a>01024 
<a name="l01025"></a>01025         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startcoils, pdu+ 1);
<a name="l01026"></a>01026         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01029"></a>01029 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39"></a><!-- doxytag: member="modbus_utils.h::MBGetReadDecreteInputs" ref="a39" args="(u8 *pdu, u16 *startdec, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startdec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus get request value from PDU. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startdec</em>&nbsp;</td><td>starting decrete inputs register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01000">1000</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00038">MBF_READ_DECRETE_INPUTS</a>.<div class="fragment"><pre class="fragment"><a name="l01001"></a>01001 {
<a name="l01002"></a>01002         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a9">MBF_READ_DECRETE_INPUTS</a>)
<a name="l01003"></a>01003                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01004"></a>01004 
<a name="l01005"></a>01005         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startdec, pdu+ 1);
<a name="l01006"></a>01006         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01009"></a>01009 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a49"></a><!-- doxytag: member="modbus_utils.h::MBGetReadFIFOQueue" ref="a49" args="(u8 *pdu, u16 *FIFOAddr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadFIFOQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>FIFOAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Read FIFO Queue function(0x18) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FIFOAddr</em>&nbsp;</td><td>FIFO address </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01218">1218</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00048">MBF_READ_FIFO_QUEUE</a>.<div class="fragment"><pre class="fragment"><a name="l01219"></a>01219 {
<a name="l01220"></a>01220         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a19">MBF_READ_FIFO_QUEUE</a>)
<a name="l01221"></a>01221                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *FIFOAddr, pdu+ 1);
<a name="l01224"></a>01224 
<a name="l01225"></a>01225         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01226"></a>01226 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a44"></a><!-- doxytag: member="modbus_utils.h::MBGetReadHoldingRegisters" ref="a44" args="(u8 *pdu, u16 *startreg, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Read Holding Registers function(0x03) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01100">1100</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00043">MBF_READ_HOLDING_REGISTERS</a>.<div class="fragment"><pre class="fragment"><a name="l01101"></a>01101 {
<a name="l01102"></a>01102         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a14">MBF_READ_HOLDING_REGISTERS</a>)
<a name="l01103"></a>01103                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01104"></a>01104 
<a name="l01105"></a>01105         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startreg, pdu+ 1);
<a name="l01106"></a>01106         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01107"></a>01107 
<a name="l01108"></a>01108         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01109"></a>01109 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a43"></a><!-- doxytag: member="modbus_utils.h::MBGetReadInputRegisters" ref="a43" args="(u8 *pdu, u16 *startreg, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Read Input Registers function(0x04) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01080">1080</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00042">MBF_READ_INPUT_REGISTERS</a>.<div class="fragment"><pre class="fragment"><a name="l01081"></a>01081 {
<a name="l01082"></a>01082         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a13">MBF_READ_INPUT_REGISTERS</a>)
<a name="l01083"></a>01083                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01084"></a>01084 
<a name="l01085"></a>01085         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startreg, pdu+ 1);
<a name="l01086"></a>01086         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01087"></a>01087 
<a name="l01088"></a>01088         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01089"></a>01089 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a47"></a><!-- doxytag: member="modbus_utils.h::MBGetReadWriteMultipleRegisters" ref="a47" args="(u8 *pdu, u16 *rsreg, u16 *rno, u16 *wsreg, u16 *wno, u8 *count, u16 *wv)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetReadWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>rno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>wsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>wno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>wv</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Read Write Multiple Registers function(0x17) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rsreg</em>&nbsp;</td><td>starting register number to read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rno</em>&nbsp;</td><td>number of registers ro read, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wsreg</em>&nbsp;</td><td>starting register number to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wno</em>&nbsp;</td><td>number of registers ro write, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value count </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wv</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01171">1171</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00046">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>.<div class="fragment"><pre class="fragment"><a name="l01172"></a>01172 {
<a name="l01173"></a>01173         <span class="keywordtype">int</span> i= 0;
<a name="l01174"></a>01174         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a17">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>)
<a name="l01175"></a>01175                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01176"></a>01176 
<a name="l01177"></a>01177         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *rsreg, pdu+ 1);
<a name="l01178"></a>01178         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *rno, pdu+ 3);
<a name="l01179"></a>01179         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *wsreg, pdu+ 5);
<a name="l01180"></a>01180         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *wno, pdu+ 7);
<a name="l01181"></a>01181         *count= pdu[ 9];
<a name="l01182"></a>01182         <span class="keywordflow">for</span>( i= 0; i&lt; (*count)/2; i++)
<a name="l01183"></a>01183                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( wv[ i], pdu+ 10+ i*2 );
<a name="l01184"></a>01184 
<a name="l01185"></a>01185         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01186"></a>01186 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a61"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseDiagnostic" ref="a61" args="(u8 *pdu, u16 *subfunc, u16 *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Diagnostic request(0x08) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>response data of request </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01467">1467</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00053">MBF_DIAGNOSTIC</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00912">MBSerialDiagnostic()</a>.<div class="fragment"><pre class="fragment"><a name="l01468"></a>01468 {
<a name="l01469"></a>01469         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a24">MBF_DIAGNOSTIC</a>)
<a name="l01470"></a>01470                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01471"></a>01471 
<a name="l01472"></a>01472         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *subfunc, pdu+ 1);
<a name="l01473"></a>01473         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *data, pdu+ 3);
<a name="l01474"></a>01474 
<a name="l01475"></a>01475         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01476"></a>01476 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a62"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseGetCommEventCounter" ref="a62" args="(u8 *pdu, u16 *status, u16 *eventcount)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseGetCommEventCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Get Comm Event Counter request(0x0B) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01487">1487</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00054">MBF_GET_COMM_EVENT_COUNTER</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00947">MBSerialGetCommEventCounter()</a>.<div class="fragment"><pre class="fragment"><a name="l01488"></a>01488 {
<a name="l01489"></a>01489         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a25">MBF_GET_COMM_EVENT_COUNTER</a>)
<a name="l01490"></a>01490                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01491"></a>01491 
<a name="l01492"></a>01492         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *status, pdu+ 1);
<a name="l01493"></a>01493         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *eventcount, pdu+ 3);
<a name="l01494"></a>01494 
<a name="l01495"></a>01495         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01496"></a>01496 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a63"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseGetCommEventLog" ref="a63" args="(u8 *buf, u16 *status, u16 *eventcount, u16 *messagecount, u8 *events)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseGetCommEventLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>messagecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>events</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Get Comm Event Counter request(0x0C) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>messagecount</em>&nbsp;</td><td>counter for processed message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>events</em>&nbsp;</td><td>new events </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01509">1509</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00055">MBF_GET_COMM_EVENT_LOG</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00981">MBSerialGetCommEventLog()</a>.<div class="fragment"><pre class="fragment"><a name="l01510"></a>01510 {
<a name="l01511"></a>01511         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> no;
<a name="l01512"></a>01512         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a26">MBF_GET_COMM_EVENT_LOG</a>)
<a name="l01513"></a>01513                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01514"></a>01514 
<a name="l01515"></a>01515         no= pdu[ 1];
<a name="l01516"></a>01516         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *status, pdu+ 2);
<a name="l01517"></a>01517         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *eventcount, pdu+ 4);
<a name="l01518"></a>01518         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *messagecount, pdu+ 6);
<a name="l01519"></a>01519 
<a name="l01520"></a>01520         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)(pdu+ 8), (<span class="keywordtype">char</span> *)events, no- 6);
<a name="l01521"></a>01521 
<a name="l01522"></a>01522         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01523"></a>01523 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a65"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseMaskWriteRegister" ref="a65" args="(u8 *pdu, u16 *reg, u16 *andmask, u16 *ormask)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseMaskWriteRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>andmask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ormask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Mask Write Register function(0x16) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>andmask</em>&nbsp;</td><td>and mask </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ormask</em>&nbsp;</td><td>or mask </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01557">1557</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00047">MBF_MASK_WRITE_REGISTER</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00813">MBSerialMaskWriteRegister()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00564">MBTCPMaskwWriteRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l01558"></a>01558 {
<a name="l01559"></a>01559         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a18">MBF_MASK_WRITE_REGISTER</a>)
<a name="l01560"></a>01560                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01561"></a>01561 
<a name="l01562"></a>01562         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *reg, pdu+ 1);
<a name="l01563"></a>01563         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *andmask, pdu+ 3);
<a name="l01564"></a>01564         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *ormask, pdu+ 5);
<a name="l01565"></a>01565 
<a name="l01566"></a>01566         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01567"></a>01567 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a52"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadCoils" ref="a52" args="(u8 *pdu, u8 *no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Response Read Coils request(0x01) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01280">1280</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00039">MBF_READ_COILS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00540">MBSerialReadCoils()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00289">MBTCPReadCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l01281"></a>01281 {
<a name="l01282"></a>01282         <span class="keywordtype">int</span> i= 0;
<a name="l01283"></a>01283         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a10">MBF_READ_COILS</a>)
<a name="l01284"></a>01284                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01285"></a>01285 
<a name="l01286"></a>01286         *no= pdu[ 1];
<a name="l01287"></a>01287         <span class="keywordflow">for</span>( i= 0; i&lt; *no; i++)
<a name="l01288"></a>01288                 value[ i]= pdu[ 2+ i];
<a name="l01289"></a>01289 
<a name="l01290"></a>01290         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01291"></a>01291 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a51"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadDecreteInputs" ref="a51" args="(u8 *pdu, u8 *no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus get response value from PDU. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01258">1258</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00038">MBF_READ_DECRETE_INPUTS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00509">MBSerialReadDecreteInputs()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00257">MBTCPReadDecreteInputs()</a>.<div class="fragment"><pre class="fragment"><a name="l01259"></a>01259 {
<a name="l01260"></a>01260         <span class="keywordtype">int</span> i= 0;
<a name="l01261"></a>01261         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a9">MBF_READ_DECRETE_INPUTS</a>)
<a name="l01262"></a>01262                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01263"></a>01263 
<a name="l01264"></a>01264         *no= pdu[ 1];
<a name="l01265"></a>01265         <span class="keywordflow">for</span>( i= 0; i&lt; *no; i++)
<a name="l01266"></a>01266                 value[ i]= pdu[ 2+ i];
<a name="l01267"></a>01267 
<a name="l01268"></a>01268         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01269"></a>01269 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a60"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadExecptionStatus" ref="a60" args="(u8 *buf, u8 status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadExecptionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a59"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadFIFOueue" ref="a59" args="(u8 *buf, u16 count, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadFIFOueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a54"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadHoldingRegisters" ref="a54" args="(u8 *pdu, u8 *no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Read Holding Registers request(0x03) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01324">1324</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00043">MBF_READ_HOLDING_REGISTERS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00674">MBSerialReadHoldingRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00425">MBTCPReadHoldingRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l01325"></a>01325 {
<a name="l01326"></a>01326         <span class="keywordtype">int</span> i= 0;
<a name="l01327"></a>01327         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a14">MBF_READ_HOLDING_REGISTERS</a>)
<a name="l01328"></a>01328                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01329"></a>01329 
<a name="l01330"></a>01330         *no= pdu[ 1];
<a name="l01331"></a>01331         <span class="keywordflow">for</span>( i= 0; i&lt; *no/2; i++)
<a name="l01332"></a>01332                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( value[ i], ( pdu+ 2+ i*2));
<a name="l01333"></a>01333 
<a name="l01334"></a>01334         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01335"></a>01335 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a53"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadInputRegisters" ref="a53" args="(u8 *pdu, u8 *no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Read Input Registers request(0x04) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01302">1302</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00042">MBF_READ_INPUT_REGISTERS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00642">MBSerialReadInputRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00393">MBTCPReadInputRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l01303"></a>01303 {
<a name="l01304"></a>01304         <span class="keywordtype">int</span> i= 0;
<a name="l01305"></a>01305         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a13">MBF_READ_INPUT_REGISTERS</a>)
<a name="l01306"></a>01306                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308         *no= pdu[ 1];
<a name="l01309"></a>01309         <span class="keywordflow">for</span>( i= 0; i&lt; *no/2; i++)
<a name="l01310"></a>01310                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( value[ i], pdu+ 2+ i*2);
<a name="l01311"></a>01311 
<a name="l01312"></a>01312         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01313"></a>01313 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a64"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReadWriteMultipleRegisters" ref="a64" args="(u8 *pdu, u8 *no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReadWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Response Read Coils request(0x17) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01534">1534</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00046">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00778">MBSerialReadWriteMultipleRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00529">MBTCPReadWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l01535"></a>01535 {
<a name="l01536"></a>01536         <span class="keywordtype">int</span> i= 0;
<a name="l01537"></a>01537         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a17">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>)
<a name="l01538"></a>01538                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01539"></a>01539 
<a name="l01540"></a>01540         *no= pdu[ 1];
<a name="l01541"></a>01541         <span class="keywordflow">for</span>( i= 0; i&lt; *no/2; i++)
<a name="l01542"></a>01542                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( value[ i], pdu+ 2+ i*2);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01545"></a>01545 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a66"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseReportSlaveID" ref="a66" args="(u8 *pdu, u8 *slave_id, u8 *status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseReportSlaveID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>slave_id</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Report Slave ID function(0x16) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>slave_id</em>&nbsp;</td><td>slave id </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>slave device status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01578">1578</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00056">MBF_REPORT_SLAVE_ID</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01013">MBSerialReportSlaveID()</a>.<div class="fragment"><pre class="fragment"><a name="l01579"></a>01579 {
<a name="l01580"></a>01580         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a27">MBF_REPORT_SLAVE_ID</a>)
<a name="l01581"></a>01581                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01582"></a>01582 
<a name="l01583"></a>01583         *slave_id= pdu[ 2];
<a name="l01584"></a>01584         *status= pdu[ 3];
<a name="l01585"></a>01585 
<a name="l01586"></a>01586         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01587"></a>01587 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a57"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseWriteMultipleCoils" ref="a57" args="(u8 *pdu, u16 *address, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseWriteMultipleCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Write Multiple Coil request(0x0F) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>number of modified coils </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01386">1386</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00041">MBF_WRITE_MULTIPLE_COILS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00603">MBSerialWriteMultipleCoils()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00354">MBTCPWriteMultipleCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l01387"></a>01387 {
<a name="l01388"></a>01388         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a12">MBF_WRITE_MULTIPLE_COILS</a>)
<a name="l01389"></a>01389                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *address, pdu+ 1);
<a name="l01392"></a>01392         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *value, pdu+ 3);
<a name="l01393"></a>01393 
<a name="l01394"></a>01394         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01395"></a>01395 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a55"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseWriteMultipleRegisters" ref="a55" args="(u8 *pdu, u16 *address, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Write Multiple Registers request(0x10) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers(1 ~ 123) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01346">1346</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00045">MBF_WRITE_MULTIPLE_REGISTERS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00740">MBSerialWriteMultipleRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00491">MBTCPWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l01347"></a>01347 {
<a name="l01348"></a>01348         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a16">MBF_WRITE_MULTIPLE_REGISTERS</a>)
<a name="l01349"></a>01349                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01350"></a>01350 
<a name="l01351"></a>01351         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *address, pdu+ 1);
<a name="l01352"></a>01352         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01353"></a>01353 
<a name="l01354"></a>01354         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01355"></a>01355 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a56"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseWriteSingleCoil" ref="a56" args="(u8 *pdu, u16 *address, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Write Single Coil request(0x05) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>output value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01366">1366</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00040">MBF_WRITE_SINGLE_COIL</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00570">MBSerialWriteSingleCoil()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00320">MBTCPWriteSingleCoil()</a>.<div class="fragment"><pre class="fragment"><a name="l01367"></a>01367 {
<a name="l01368"></a>01368         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a11">MBF_WRITE_SINGLE_COIL</a>)
<a name="l01369"></a>01369                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01370"></a>01370 
<a name="l01371"></a>01371         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *address, pdu+ 1);
<a name="l01372"></a>01372         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *value, pdu+ 3);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01375"></a>01375 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a58"></a><!-- doxytag: member="modbus_utils.h::MBGetResponseWriteSingleRegister" ref="a58" args="(u8 *pdu, u16 *address, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetResponseWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse response PDU packet of Write Single Register request(0x06) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>output value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01406">1406</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00044">MBF_WRITE_SINGLE_REGISTER</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00705">MBSerialWriteSingleRegister()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00456">MBTCPWriteSingleRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l01407"></a>01407 {
<a name="l01408"></a>01408         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a15">MBF_WRITE_SINGLE_REGISTER</a>)
<a name="l01409"></a>01409                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *address, pdu+ 1);
<a name="l01412"></a>01412         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *value, pdu+ 3);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01415"></a>01415 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a42"></a><!-- doxytag: member="modbus_utils.h::MBGetWriteMultipleCoils" ref="a42" args="(u8 *pdu, u16 *startcoils, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetWriteMultipleCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Write Multiple Coils function(0x0F) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01060">1060</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00041">MBF_WRITE_MULTIPLE_COILS</a>.<div class="fragment"><pre class="fragment"><a name="l01061"></a>01061 {
<a name="l01062"></a>01062         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a12">MBF_WRITE_MULTIPLE_COILS</a>)
<a name="l01063"></a>01063                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startcoils, pdu+ 1);
<a name="l01066"></a>01066         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *no, pdu+ 3);
<a name="l01067"></a>01067 
<a name="l01068"></a>01068         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01069"></a>01069 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a46"></a><!-- doxytag: member="modbus_utils.h::MBGetWriteMultipleRegisters" ref="a46" args="(u8 *pdu, u16 *startreg, u16 *no, u8 *count, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>noreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Write Multiple Registers function(0x10) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>noreg</em>&nbsp;</td><td>number of registers, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01142">1142</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00045">MBF_WRITE_MULTIPLE_REGISTERS</a>.<div class="fragment"><pre class="fragment"><a name="l01143"></a>01143 {
<a name="l01144"></a>01144         <span class="keywordtype">int</span> i= 0;
<a name="l01145"></a>01145         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a16">MBF_WRITE_MULTIPLE_REGISTERS</a>)
<a name="l01146"></a>01146                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01147"></a>01147 
<a name="l01148"></a>01148         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *startreg, pdu+ 1);
<a name="l01149"></a>01149         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *noreg, pdu+ 3);
<a name="l01150"></a>01150         *count= pdu[ 5];
<a name="l01151"></a>01151 
<a name="l01152"></a>01152         <span class="keywordflow">for</span>( i= 0; i&lt; (*count)/2; i++)
<a name="l01153"></a>01153                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( value[ i], pdu+ 6+ i* 2);
<a name="l01154"></a>01154 
<a name="l01155"></a>01155         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01156"></a>01156 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a41"></a><!-- doxytag: member="modbus_utils.h::MBGetWriteSingleCoil" ref="a41" args="(u8 *pdu, u16 *coilreg, u16 *onoff)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>coilreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>onoff</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Write Single Coil function(0x05) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>coilreg</em>&nbsp;</td><td>coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>onoff</em>&nbsp;</td><td>0xFF00 for on,0x0000 for off. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01040">1040</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00040">MBF_WRITE_SINGLE_COIL</a>.<div class="fragment"><pre class="fragment"><a name="l01041"></a>01041 {
<a name="l01042"></a>01042         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a11">MBF_WRITE_SINGLE_COIL</a>)
<a name="l01043"></a>01043                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *coilreg, pdu+ 1);
<a name="l01046"></a>01046         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *onoff, pdu+ 3);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01049"></a>01049 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a45"></a><!-- doxytag: member="modbus_utils.h::MBGetWriteSingleRegister" ref="a45" args="(u8 *pdu, u16 *devicereg, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBGetWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>devicereg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
parse PDU packet of Write Single Register function(0x06) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>the request PDU data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>devicereg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>MB_OK for success, on error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l01120">1120</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00037">GETU16</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00078">MB_ERROR_FUNCTION</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00063">MB_OK</a>, and <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00044">MBF_WRITE_SINGLE_REGISTER</a>.<div class="fragment"><pre class="fragment"><a name="l01121"></a>01121 {
<a name="l01122"></a>01122         <span class="keywordflow">if</span>( pdu[ 0] != <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a15">MBF_WRITE_SINGLE_REGISTER</a>)
<a name="l01123"></a>01123                 <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a47">MB_ERROR_FUNCTION</a>;
<a name="l01124"></a>01124 
<a name="l01125"></a>01125         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *devicereg, pdu+ 1);
<a name="l01126"></a>01126         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a0">GETU16</a>( *value, pdu+ 3);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a32">MB_OK</a>;
<a name="l01129"></a>01129 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6"></a><!-- doxytag: member="modbus_utils.h::MBMakeADU" ref="a6" args="(u8 *buf, int protocol, u8 address, const u8 *pdu, int len, u16 tid)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBMakeADU           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const <a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>tid</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Modbus utilities functions. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>protocol</em>&nbsp;</td><td>which Modbus protocol to use </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>address of the destination device </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pdu</em>&nbsp;</td><td>PDU part </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the PDU part </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tid</em>&nbsp;</td><td>transaction used for Modbus TCP protocol </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of data after assemble. On error return error code</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00214">214</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00079">CRC16()</a>, <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00107">LRC()</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00028">MB_ASCII_ADU_MAX_LENGTH</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00031">MB_ASCII_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00077">MB_ERROR_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00030">MB_RTU_PROTOCOL</a>, <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00032">MB_TCP_PROTOCOL</a>, and <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00177">MBDataToASCII()</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00280">MBSerialWrite()</a>.<div class="fragment"><pre class="fragment"><a name="l00215"></a>00215 {
<a name="l00216"></a>00216         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> tmp[ <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a3">MB_ASCII_ADU_MAX_LENGTH</a>];
<a name="l00217"></a>00217         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> lrc;
<a name="l00218"></a>00218         <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> crc;
<a name="l00219"></a>00219         <span class="keywordtype">int</span> i= 0, tmp_len= 0, buf_len= 0;
<a name="l00220"></a>00220 
<a name="l00221"></a>00221         <span class="keywordflow">switch</span>( protocol)
<a name="l00222"></a>00222         {
<a name="l00223"></a>00223                 <span class="keywordflow">case</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a5">MB_ASCII_PROTOCOL</a>:
<a name="l00224"></a>00224                         buf[ 0]= <span class="charliteral">':'</span>;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226                         tmp[ 0]= address;
<a name="l00227"></a>00227                         tmp_len++;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229                         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)pdu, (<span class="keywordtype">char</span> *)(tmp+ tmp_len), len);
<a name="l00230"></a>00230                         tmp_len+= len;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232                         lrc= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a3">LRC</a>( tmp, tmp_len);
<a name="l00233"></a>00233                         tmp[ tmp_len++]= lrc;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235                         buf_len= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a5">MBDataToASCII</a>( buf+ 1, tmp, tmp_len);
<a name="l00236"></a>00236                         buf_len++;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238                         buf[ buf_len++]= 0xd;
<a name="l00239"></a>00239                         buf[ buf_len++]= 0xa;
<a name="l00240"></a>00240                         <span class="keywordflow">break</span>;
<a name="l00241"></a>00241                 <span class="keywordflow">case</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a4">MB_RTU_PROTOCOL</a>:
<a name="l00242"></a>00242                         buf[ 0]= address;
<a name="l00243"></a>00243                         buf_len++;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245                         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)pdu, (<span class="keywordtype">char</span> *)(buf+ 1), len);
<a name="l00246"></a>00246                         buf_len+= len;
<a name="l00247"></a>00247 
<a name="l00248"></a>00248                         crc= <a class="code" href="../../d4/d81/modbus__utils_8c.html#a2">CRC16</a>( buf, buf_len);
<a name="l00249"></a>00249                         buf[ buf_len++]= crc &gt;&gt; 8;
<a name="l00250"></a>00250                         buf[ buf_len++]= crc &amp; 0x00FF;
<a name="l00251"></a>00251                         <span class="keywordflow">break</span>;
<a name="l00252"></a>00252                 <span class="keywordflow">case</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a6">MB_TCP_PROTOCOL</a>:
<a name="l00253"></a>00253                         buf[ 0]= tid &gt;&gt; 8;
<a name="l00254"></a>00254                         buf[ 1]= tid &amp; 0x00FF;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256                         buf[ 2]= 0;
<a name="l00257"></a>00257                         buf[ 3]= 0;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259                         buf[ 4]= (len+1) &gt;&gt; 8;          <span class="comment">// length of address + pdu</span>
<a name="l00260"></a>00260                         buf[ 5]= (len+1) &amp; 0x00FF;      <span class="comment">// length of address + pdu</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262                         buf[ 6]= address;
<a name="l00263"></a>00263 
<a name="l00264"></a>00264                         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)pdu, (<span class="keywordtype">char</span> *)(buf+ 7), len);
<a name="l00265"></a>00265                         buf_len= 7+ len;
<a name="l00266"></a>00266                         <span class="keywordflow">break</span>;
<a name="l00267"></a>00267                 <span class="keywordflow">default</span>:
<a name="l00268"></a>00268                         <span class="keywordflow">return</span> <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a46">MB_ERROR_PROTOCOL</a>;
<a name="l00269"></a>00269         }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271         <span class="keywordflow">return</span> buf_len;
<a name="l00272"></a>00272 }
</pre></div>
<p>

<p>
Here is the call graph for this function:<p><center><img src="../../d9/d8e/modbus__utils_8h_a6_cgraph.png" border="0" usemap="#d9/d8e/modbus__utils_8h_a6_cgraph_map" alt=""></center>
<map name="d9/d8e/modbus__utils_8h_a6_cgraph_map">
<area href="../../d4/d81/modbus__utils_8c.html#a2" shape="rect" coords="187,7,251,33" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a3" shape="rect" coords="195,57,243,84" alt="">
<area href="../../d4/d81/modbus__utils_8c.html#a5" shape="rect" coords="159,108,279,135" alt="">
</map>
    </td>
  </tr>
</table>
<a class="anchor" name="a8"></a><!-- doxytag: member="modbus_utils.h::MBMakePDU" ref="a8" args="(u8 *buf, u8 function, u8 *data, int len)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBMakePDU           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>function</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>len</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
assemble function code and data to ADU 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>function</em>&nbsp;</td><td>function code of the data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>length of the data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00303">303</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.<div class="fragment"><pre class="fragment"><a name="l00304"></a>00304 {
<a name="l00305"></a>00305         <span class="keywordtype">int</span> ret_len= 0;
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         buf[ 0]= function;
<a name="l00308"></a>00308         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)data, (<span class="keywordtype">char</span> *)(buf+ 1), len);
<a name="l00309"></a>00309         ret_len= len+ 1;
<a name="l00310"></a>00310 
<a name="l00311"></a>00311         <span class="keywordflow">return</span> ret_len;
<a name="l00312"></a>00312 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a20"></a><!-- doxytag: member="modbus_utils.h::MBMaskWriteRegister" ref="a20" args="(u8 *buf, u16 reg, u16 andmask, u16 ormask)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBMaskWriteRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>reg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>andmask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ormask</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x16 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>andmask</em>&nbsp;</td><td>and mask </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ormask</em>&nbsp;</td><td>or mask </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00578">578</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00047">MBF_MASK_WRITE_REGISTER</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00813">MBSerialMaskWriteRegister()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00564">MBTCPMaskwWriteRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l00579"></a>00579 {
<a name="l00580"></a>00580         <span class="keywordtype">int</span> len= 0;
<a name="l00581"></a>00581         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a18">MBF_MASK_WRITE_REGISTER</a>;
<a name="l00582"></a>00582         len++;
<a name="l00583"></a>00583         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, reg);                 <span class="comment">// don't put ++ in the macro</span>
<a name="l00584"></a>00584         len+= 2;
<a name="l00585"></a>00585         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, andmask);
<a name="l00586"></a>00586         len+= 2;
<a name="l00587"></a>00587         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, ormask);
<a name="l00588"></a>00588         len+= 2;
<a name="l00589"></a>00589 
<a name="l00590"></a>00590         <span class="keywordflow">return</span> len;
<a name="l00591"></a>00591 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12"></a><!-- doxytag: member="modbus_utils.h::MBReadCoils" ref="a12" args="(u8 *buf, u16 startcoils, u16 no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x01 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00371">371</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00039">MBF_READ_COILS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00540">MBSerialReadCoils()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00289">MBTCPReadCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l00372"></a>00372 {
<a name="l00373"></a>00373         <span class="keywordtype">int</span> len= 0;
<a name="l00374"></a>00374         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a10">MBF_READ_COILS</a>;
<a name="l00375"></a>00375         len++;
<a name="l00376"></a>00376         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startcoils);          <span class="comment">// don't put ++ in the macro</span>
<a name="l00377"></a>00377         len+= 2;
<a name="l00378"></a>00378         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, no);
<a name="l00379"></a>00379         len+= 2;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         <span class="keywordflow">return</span> len;
<a name="l00382"></a>00382 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a11"></a><!-- doxytag: member="modbus_utils.h::MBReadDecreteInputs" ref="a11" args="(u8 *buf, u16 startdec, u16 no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startdec</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Master function 0x02. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startdec</em>&nbsp;</td><td>starting decrete inputs register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00349">349</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00038">MBF_READ_DECRETE_INPUTS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00509">MBSerialReadDecreteInputs()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00257">MBTCPReadDecreteInputs()</a>.<div class="fragment"><pre class="fragment"><a name="l00350"></a>00350 {
<a name="l00351"></a>00351         <span class="keywordtype">int</span> len= 0;
<a name="l00352"></a>00352         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a9">MBF_READ_DECRETE_INPUTS</a>;
<a name="l00353"></a>00353         len++;
<a name="l00354"></a>00354         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startdec);            <span class="comment">// don't put ++ in the macro</span>
<a name="l00355"></a>00355         len+= 2;
<a name="l00356"></a>00356         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, no);
<a name="l00357"></a>00357         len+= 2;
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         <span class="keywordflow">return</span> len;
<a name="l00360"></a>00360 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22"></a><!-- doxytag: member="modbus_utils.h::MBReadExceptionStatus" ref="a22" args="(u8 *buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadExceptionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>buf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x07 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00622">622</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00052">MBF_READ_EXCEPTION_STATUS</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00880">MBSerialReadExceptionStatus()</a>.<div class="fragment"><pre class="fragment"><a name="l00623"></a>00623 {
<a name="l00624"></a>00624         <span class="keywordtype">int</span> len= 0;
<a name="l00625"></a>00625         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a23">MBF_READ_EXCEPTION_STATUS</a>;
<a name="l00626"></a>00626         len++;
<a name="l00627"></a>00627 
<a name="l00628"></a>00628         <span class="keywordflow">return</span> len;
<a name="l00629"></a>00629 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a21"></a><!-- doxytag: member="modbus_utils.h::MBReadFIFOQueue" ref="a21" args="(u8 *buf, u16 FIFOAddr)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadFIFOQueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FIFOAddr</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x18 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FIFOAddr</em>&nbsp;</td><td>FIFO address </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00601">601</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00048">MBF_READ_FIFO_QUEUE</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00848">MBSerialReadFIFOQueue()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00599">MBTCPReadFIFOQueue()</a>.<div class="fragment"><pre class="fragment"><a name="l00602"></a>00602 {
<a name="l00603"></a>00603         <span class="keywordtype">int</span> len= 0;
<a name="l00604"></a>00604         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a19">MBF_READ_FIFO_QUEUE</a>;
<a name="l00605"></a>00605         len++;
<a name="l00606"></a>00606         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, FIFOAddr);            <span class="comment">// don't put ++ in the macro</span>
<a name="l00607"></a>00607         len+= 2;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609         <span class="keywordflow">return</span> len;
<a name="l00610"></a>00610 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16"></a><!-- doxytag: member="modbus_utils.h::MBReadHoldingRegisters" ref="a16" args="(u8 *buf, u16 startreg, u16 no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x03 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00469">469</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00043">MBF_READ_HOLDING_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00674">MBSerialReadHoldingRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00425">MBTCPReadHoldingRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00470"></a>00470 {
<a name="l00471"></a>00471         <span class="keywordtype">int</span> len= 0;
<a name="l00472"></a>00472         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a14">MBF_READ_HOLDING_REGISTERS</a>;
<a name="l00473"></a>00473         len++;
<a name="l00474"></a>00474         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startreg);            <span class="comment">// don't put ++ in the macro</span>
<a name="l00475"></a>00475         len+= 2;
<a name="l00476"></a>00476         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, no);
<a name="l00477"></a>00477         len+= 2;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479         <span class="keywordflow">return</span> len;
<a name="l00480"></a>00480 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15"></a><!-- doxytag: member="modbus_utils.h::MBReadInputRegisters" ref="a15" args="(u8 *buf, u16 startreg, u16 no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x04 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 125 </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00447">447</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00042">MBF_READ_INPUT_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00642">MBSerialReadInputRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00393">MBTCPReadInputRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00448"></a>00448 {
<a name="l00449"></a>00449         <span class="keywordtype">int</span> len= 0;
<a name="l00450"></a>00450         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a13">MBF_READ_INPUT_REGISTERS</a>;
<a name="l00451"></a>00451         len++;
<a name="l00452"></a>00452         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startreg);            <span class="comment">// don't put ++ in the macro</span>
<a name="l00453"></a>00453         len+= 2;
<a name="l00454"></a>00454         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, no);
<a name="l00455"></a>00455         len+= 2;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457         <span class="keywordflow">return</span> len;
<a name="l00458"></a>00458 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a19"></a><!-- doxytag: member="modbus_utils.h::MBReadWriteMultipleRegisters" ref="a19" args="(u8 *buf, u16 rsreg, u16 rno, u16 wsreg, u16 wno, u8 count, u16 *wv)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReadWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>wsreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>wno</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>wv</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x17 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rsreg</em>&nbsp;</td><td>starting register number to read </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rno</em>&nbsp;</td><td>number of registers ro read, between 1 ~ 118 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wsreg</em>&nbsp;</td><td>starting register number to write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wno</em>&nbsp;</td><td>number of registers ro write, between 1 ~ 118 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>wv</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00547">547</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00046">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00778">MBSerialReadWriteMultipleRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00529">MBTCPReadWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00548"></a>00548 {
<a name="l00549"></a>00549         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00550"></a>00550         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a17">MBF_READ_WRITE_MULTIPLE_REGISTERS</a>;
<a name="l00551"></a>00551         len++;
<a name="l00552"></a>00552         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, rsreg);               <span class="comment">// don't put ++ in the macro</span>
<a name="l00553"></a>00553         len+= 2;
<a name="l00554"></a>00554         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, rno);
<a name="l00555"></a>00555         len+= 2;
<a name="l00556"></a>00556         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, wsreg);
<a name="l00557"></a>00557         len+= 2;
<a name="l00558"></a>00558         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, wno);
<a name="l00559"></a>00559         len+= 2;
<a name="l00560"></a>00560         buf[ len++]= count;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562         <span class="keywordflow">for</span>( i= 0; i&lt; wno/2; i++, len+= 2)
<a name="l00563"></a>00563                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, wv[ i]);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565         <span class="keywordflow">return</span> len;
<a name="l00566"></a>00566 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26"></a><!-- doxytag: member="modbus_utils.h::MBReportSlaveID" ref="a26" args="(u8 *buf)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBReportSlaveID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>buf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x11 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00692">692</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00056">MBF_REPORT_SLAVE_ID</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01013">MBSerialReportSlaveID()</a>.<div class="fragment"><pre class="fragment"><a name="l00693"></a>00693 {
<a name="l00694"></a>00694         <span class="keywordtype">int</span> len= 0;
<a name="l00695"></a>00695         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a27">MBF_REPORT_SLAVE_ID</a>;
<a name="l00696"></a>00696         len++;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698         <span class="keywordflow">return</span> len;
<a name="l00699"></a>00699 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36"></a><!-- doxytag: member="modbus_utils.h::MBResponseDiagnostic" ref="a36" args="(u8 *buf, u16 subfunc, u16 data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseDiagnostic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>subfunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Diagnostic request(0x08) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>subfunc</em>&nbsp;</td><td>subfunction code </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>response data of request </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00924">924</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00053">MBF_DIAGNOSTIC</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01280">MBSerialSendDiagnostic()</a>.<div class="fragment"><pre class="fragment"><a name="l00925"></a>00925 {
<a name="l00926"></a>00926         <span class="keywordtype">int</span> len= 0;
<a name="l00927"></a>00927         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a24">MBF_DIAGNOSTIC</a>;
<a name="l00928"></a>00928         len++;
<a name="l00929"></a>00929         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, subfunc);
<a name="l00930"></a>00930         len+= 2;
<a name="l00931"></a>00931         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, data);
<a name="l00932"></a>00932         len+= 2;
<a name="l00933"></a>00933 
<a name="l00934"></a>00934         <span class="keywordflow">return</span> len;
<a name="l00935"></a>00935 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a37"></a><!-- doxytag: member="modbus_utils.h::MBResponseGetCommEventCounter" ref="a37" args="(u8 *buf, u16 status, u16 eventcount)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseGetCommEventCounter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Get Comm Event Counter request(0x0B) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00946">946</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00054">MBF_GET_COMM_EVENT_COUNTER</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01306">MBSerialSendGetCommEventCounter()</a>.<div class="fragment"><pre class="fragment"><a name="l00947"></a>00947 {
<a name="l00948"></a>00948         <span class="keywordtype">int</span> len= 0;
<a name="l00949"></a>00949         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a25">MBF_GET_COMM_EVENT_COUNTER</a>;
<a name="l00950"></a>00950         len++;
<a name="l00951"></a>00951         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, status);
<a name="l00952"></a>00952         len+= 2;
<a name="l00953"></a>00953         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, eventcount);
<a name="l00954"></a>00954         len+= 2;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956         <span class="keywordflow">return</span> len;
<a name="l00957"></a>00957 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a38"></a><!-- doxytag: member="modbus_utils.h::MBResponseGetCommEventLog" ref="a38" args="(u8 *buf, u8 no, u16 status, u16 eventcount, u16 messagecount, u8 *events)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseGetCommEventLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>eventcount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>messagecount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>events</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Get Comm Event Counter request(0x0C) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of the following data </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>status</em>&nbsp;</td><td>status of Comm Conuter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>eventcount</em>&nbsp;</td><td>event counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>messagecount</em>&nbsp;</td><td>counter for processed message </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>events</em>&nbsp;</td><td>new events </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00971">971</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00055">MBF_GET_COMM_EVENT_LOG</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01335">MBSerialSendGetCommEventLog()</a>.<div class="fragment"><pre class="fragment"><a name="l00972"></a>00972 {
<a name="l00973"></a>00973         <span class="keywordtype">int</span> len= 0;
<a name="l00974"></a>00974         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a26">MBF_GET_COMM_EVENT_LOG</a>;
<a name="l00975"></a>00975         len++;
<a name="l00976"></a>00976         buf[ len]= no;
<a name="l00977"></a>00977         len++;
<a name="l00978"></a>00978         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, status);
<a name="l00979"></a>00979         len+= 2;
<a name="l00980"></a>00980         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, eventcount);
<a name="l00981"></a>00981         len+= 2;
<a name="l00982"></a>00982         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, messagecount);
<a name="l00983"></a>00983         len+= 2;
<a name="l00984"></a>00984 
<a name="l00985"></a>00985         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)events, (<span class="keywordtype">char</span> *)(buf+ len), no- 6);
<a name="l00986"></a>00986 
<a name="l00987"></a>00987         <span class="keywordflow">return</span> len;
<a name="l00988"></a>00988 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a28"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadCoils" ref="a28" args="(u8 *buf, u8 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Response Read Coils request(0x01) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00739">739</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00039">MBF_READ_COILS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01072">MBSerialSendReadCoils()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00658">MBTCPSendReadCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l00740"></a>00740 {
<a name="l00741"></a>00741         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00742"></a>00742         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a10">MBF_READ_COILS</a>;
<a name="l00743"></a>00743         len++;
<a name="l00744"></a>00744         buf[ len]= no;
<a name="l00745"></a>00745         len++;
<a name="l00746"></a>00746         <span class="keywordflow">if</span>( no &amp; 0x07)                  <span class="comment">// test if no could be divied by 8</span>
<a name="l00747"></a>00747                 no= (no &gt;&gt; 3) + 1;
<a name="l00748"></a>00748         <span class="keywordflow">else</span>
<a name="l00749"></a>00749                 no&gt;&gt;= 3;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         <span class="keywordflow">for</span>( i= 0; i&lt; no/2; i++, len+= 2)
<a name="l00752"></a>00752                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value[ i]);
<a name="l00753"></a>00753 
<a name="l00754"></a>00754 
<a name="l00755"></a>00755         <span class="keywordflow">return</span> len;
<a name="l00756"></a>00756 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadDecreteInputs" ref="a27" args="(u8 *buf, u8 no, u8 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadDecreteInputs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Response function. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00711">711</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00038">MBF_READ_DECRETE_INPUTS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01046">MBSerialSendReadDecreteInputs()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00632">MBTCPSendReadDecreteInputs()</a>.<div class="fragment"><pre class="fragment"><a name="l00712"></a>00712 {
<a name="l00713"></a>00713         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00714"></a>00714         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a9">MBF_READ_DECRETE_INPUTS</a>;
<a name="l00715"></a>00715         len++;
<a name="l00716"></a>00716         buf[ len]= no;
<a name="l00717"></a>00717         len++;
<a name="l00718"></a>00718         <span class="keywordflow">if</span>( no &amp; 0x07)                  <span class="comment">// test if no could be divied by 8</span>
<a name="l00719"></a>00719                 no= (no &gt;&gt; 3) + 1;
<a name="l00720"></a>00720         <span class="keywordflow">else</span>
<a name="l00721"></a>00721                 no&gt;&gt;= 3;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723         <span class="keywordflow">for</span>( i= 0; i&lt; no/2; i++, len+= 2)
<a name="l00724"></a>00724                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value[ i]);
<a name="l00725"></a>00725 
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         <span class="keywordflow">return</span> len;
<a name="l00728"></a>00728 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a35"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadExecptionStatus" ref="a35" args="(u8 *buf, u8 status)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadExecptionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>status</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a34"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadFIFOueue" ref="a34" args="(u8 *buf, u16 count, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadFIFOueue           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadHoldingRegisters" ref="a30" args="(u8 *buf, u8 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadHoldingRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Read Holding Registers request(0x03) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00790">790</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00043">MBF_READ_HOLDING_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01124">MBSerialSendReadHoldingRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00710">MBTCPSendReadHoldingRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00791"></a>00791 {
<a name="l00792"></a>00792         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00793"></a>00793         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a14">MBF_READ_HOLDING_REGISTERS</a>;
<a name="l00794"></a>00794         len++;
<a name="l00795"></a>00795         buf[ len]= no;
<a name="l00796"></a>00796         len++;
<a name="l00797"></a>00797 
<a name="l00798"></a>00798         <span class="keywordflow">for</span>( i= 0; i&lt; no/2; i++, len+= 2)
<a name="l00799"></a>00799                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value[ i]);
<a name="l00800"></a>00800 
<a name="l00801"></a>00801         <span class="keywordflow">return</span> len;
<a name="l00802"></a>00802 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29"></a><!-- doxytag: member="modbus_utils.h::MBResponseReadInputRegisters" ref="a29" args="(u8 *buf, u8 no, u16 *value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseReadInputRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Read Input Registers request(0x04) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>registers status </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00767">767</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00042">MBF_READ_INPUT_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01098">MBSerialSendReadInputRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00684">MBTCPSendReadInputRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00768"></a>00768 {
<a name="l00769"></a>00769         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00770"></a>00770         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a13">MBF_READ_INPUT_REGISTERS</a>;
<a name="l00771"></a>00771         len++;
<a name="l00772"></a>00772         buf[ len]= no;
<a name="l00773"></a>00773         len++;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775         <span class="keywordflow">for</span>( i= 0; i&lt; no/2; i++, len+= 2)
<a name="l00776"></a>00776                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value[ i]);
<a name="l00777"></a>00777 
<a name="l00778"></a>00778         <span class="keywordflow">return</span> len;
<a name="l00779"></a>00779 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31"></a><!-- doxytag: member="modbus_utils.h::MBResponseWriteMultipleRegisters" ref="a31" args="(u8 *buf, u16 startdevreg, u16 no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Write Multiple Registers request(0x10) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers(1 ~ 123) </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00813">813</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00045">MBF_WRITE_MULTIPLE_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01150">MBSerialSendWriteMultipleRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00738">MBTCPSendWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00814"></a>00814 {
<a name="l00815"></a>00815         <span class="keywordtype">int</span> len= 0;
<a name="l00816"></a>00816         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a16">MBF_WRITE_MULTIPLE_REGISTERS</a>;
<a name="l00817"></a>00817         len++;
<a name="l00818"></a>00818         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, address);
<a name="l00819"></a>00819         len+= 2;
<a name="l00820"></a>00820         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, no);
<a name="l00821"></a>00821         len+= 2;
<a name="l00822"></a>00822 
<a name="l00823"></a>00823         <span class="keywordflow">return</span> len;
<a name="l00824"></a>00824 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32"></a><!-- doxytag: member="modbus_utils.h::MBResponseWriteSingleCoil" ref="a32" args="(u8 *buf, u16 coilreg, u16 onoff)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Write Single Coil request(0x05) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>output value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00835">835</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00040">MBF_WRITE_SINGLE_COIL</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01176">MBSerialSendWriteSingleCoil()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00764">MBTCPSendWriteSingleCoil()</a>.<div class="fragment"><pre class="fragment"><a name="l00836"></a>00836 {
<a name="l00837"></a>00837         <span class="keywordtype">int</span> len= 0;
<a name="l00838"></a>00838         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a11">MBF_WRITE_SINGLE_COIL</a>;
<a name="l00839"></a>00839         len++;
<a name="l00840"></a>00840         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, address);
<a name="l00841"></a>00841         len+= 2;
<a name="l00842"></a>00842         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value);
<a name="l00843"></a>00843         len+= 2;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845         <span class="keywordflow">return</span> len;
<a name="l00846"></a>00846 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33"></a><!-- doxytag: member="modbus_utils.h::MBResponseWriteSingleRegister" ref="a33" args="(u8 *buf, u16 reg, u16 value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBResponseWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
make response PDU packet of Write Single Register request(0x06) 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>address</em>&nbsp;</td><td>start address of register </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>output value </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00857">857</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00044">MBF_WRITE_SINGLE_REGISTER</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l01202">MBSerialSendWriteSingleRegister()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00790">MBTCPSendWriteSingleRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l00858"></a>00858 {
<a name="l00859"></a>00859         <span class="keywordtype">int</span> len= 0;
<a name="l00860"></a>00860         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a15">MBF_WRITE_SINGLE_REGISTER</a>;
<a name="l00861"></a>00861         len++;
<a name="l00862"></a>00862         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, address);
<a name="l00863"></a>00863         len+= 2;
<a name="l00864"></a>00864         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value);
<a name="l00865"></a>00865         len+= 2;
<a name="l00866"></a>00866 
<a name="l00867"></a>00867         <span class="keywordflow">return</span> len;
<a name="l00868"></a>00868 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14"></a><!-- doxytag: member="modbus_utils.h::MBWriteMultipleCoils" ref="a14" args="(u8 *buf, u16 startcoils, u16 no, u8 count, u8 *data)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBWriteMultipleCoils           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startcoils</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>no</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>data</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x0F 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startcoils</em>&nbsp;</td><td>starting coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>no</em>&nbsp;</td><td>number of registers, between 1 ~ 2000 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>equal to no/8 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>output data </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00417">417</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00041">MBF_WRITE_MULTIPLE_COILS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00603">MBSerialWriteMultipleCoils()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00354">MBTCPWriteMultipleCoils()</a>.<div class="fragment"><pre class="fragment"><a name="l00418"></a>00418 {
<a name="l00419"></a>00419         <span class="keywordtype">int</span> len= 0;
<a name="l00420"></a>00420         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a12">MBF_WRITE_MULTIPLE_COILS</a>;
<a name="l00421"></a>00421         len++;
<a name="l00422"></a>00422         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startcoils);          <span class="comment">// don't put ++ in the macro</span>
<a name="l00423"></a>00423         len+= 2;
<a name="l00424"></a>00424         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, no);
<a name="l00425"></a>00425         len+= 2;
<a name="l00426"></a>00426         buf[ len]= count;
<a name="l00427"></a>00427         len++;
<a name="l00428"></a>00428         <span class="keywordflow">if</span>( count &amp; 0x07)                       <span class="comment">// test if no could be divied by 8</span>
<a name="l00429"></a>00429                 count = ( count &gt;&gt; 3)+ 1;
<a name="l00430"></a>00430         <span class="keywordflow">else</span>
<a name="l00431"></a>00431                 count &gt;&gt;= 3;
<a name="l00432"></a>00432         bcopy( (<span class="keyword">const</span> <span class="keywordtype">char</span> *)data, (<span class="keywordtype">char</span> *)(buf+ len), count);
<a name="l00433"></a>00433         len+= count;
<a name="l00434"></a>00434 
<a name="l00435"></a>00435         <span class="keywordflow">return</span> len;
<a name="l00436"></a>00436 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18"></a><!-- doxytag: member="modbus_utils.h::MBWriteMultipleRegisters" ref="a18" args="(u8 *buf, u16 startreg, u16 noreg, u8 count, u16 *no)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBWriteMultipleRegisters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>startreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>noreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>count</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x10 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startreg</em>&nbsp;</td><td>starting register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>noreg</em>&nbsp;</td><td>number of registers, between 1 ~ 120 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>value counter </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00515">515</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00045">MBF_WRITE_MULTIPLE_REGISTERS</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00740">MBSerialWriteMultipleRegisters()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00491">MBTCPWriteMultipleRegisters()</a>.<div class="fragment"><pre class="fragment"><a name="l00516"></a>00516 {
<a name="l00517"></a>00517         <span class="keywordtype">int</span> len= 0, i= 0;
<a name="l00518"></a>00518         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a16">MBF_WRITE_MULTIPLE_REGISTERS</a>;
<a name="l00519"></a>00519         len++;
<a name="l00520"></a>00520         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, startreg);            <span class="comment">// don't put ++ in the macro</span>
<a name="l00521"></a>00521         len+= 2;
<a name="l00522"></a>00522         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, noreg);
<a name="l00523"></a>00523         len+= 2;
<a name="l00524"></a>00524         buf[ len]= count;
<a name="l00525"></a>00525         len++;
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         <span class="keywordflow">for</span>( i= 0; i&lt; count/2; i++, len+= 2)
<a name="l00528"></a>00528                 <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+len, value[ i]);
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 
<a name="l00531"></a>00531         <span class="keywordflow">return</span> len;
<a name="l00532"></a>00532 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13"></a><!-- doxytag: member="modbus_utils.h::MBWriteSingleCoil" ref="a13" args="(u8 *buf, u16 coilreg, u16 onoff)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBWriteSingleCoil           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>coilreg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>onoff</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x05 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>coilreg</em>&nbsp;</td><td>coil register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>onoff</em>&nbsp;</td><td>0xFF00 for on,0x0000 for off </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00393">393</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00040">MBF_WRITE_SINGLE_COIL</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00570">MBSerialWriteSingleCoil()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00320">MBTCPWriteSingleCoil()</a>.<div class="fragment"><pre class="fragment"><a name="l00394"></a>00394 {
<a name="l00395"></a>00395         <span class="keywordtype">int</span> len= 0;
<a name="l00396"></a>00396         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a11">MBF_WRITE_SINGLE_COIL</a>;
<a name="l00397"></a>00397         len++;
<a name="l00398"></a>00398         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, coilreg);             <span class="comment">// don't put ++ in the macro</span>
<a name="l00399"></a>00399         len+= 2;
<a name="l00400"></a>00400         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, onoff);
<a name="l00401"></a>00401         len+= 2;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403         <span class="keywordflow">return</span> len;
<a name="l00404"></a>00404 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17"></a><!-- doxytag: member="modbus_utils.h::MBWriteSingleRegister" ref="a17" args="(u8 *buf, u16 devicereg, u16 value)" --><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int MBWriteSingleRegister           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a49">u8</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>devicereg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap><a class="el" href="../../d7/dcc/modbus__defs_8h.html#a50">u16</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>value</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
0x06 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>buf</em>&nbsp;</td><td>output buffer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>devicereg</em>&nbsp;</td><td>register number </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>value to write </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the length of PDU data</dd></dl>

<p>
Definition at line <a class="el" href="../../de/da7/modbus__utils_8c-source.html#l00491">491</a> of file <a class="el" href="../../de/da7/modbus__utils_8c-source.html">modbus_utils.c</a>.
<p>
References <a class="el" href="../../d5/d2a/modbus__defs_8h-source.html#l00044">MBF_WRITE_SINGLE_REGISTER</a>, and <a class="el" href="../../d1/d17/modbus__utils_8h-source.html#l00049">PUTU16</a>.
<p>
Referenced by <a class="el" href="../../de/d42/mbserial_8c-source.html#l00705">MBSerialWriteSingleRegister()</a>, and <a class="el" href="../../df/d04/mbtcp_8c-source.html#l00456">MBTCPWriteSingleRegister()</a>.<div class="fragment"><pre class="fragment"><a name="l00492"></a>00492 {
<a name="l00493"></a>00493         <span class="keywordtype">int</span> len= 0;
<a name="l00494"></a>00494         buf[ len]= <a class="code" href="../../d7/dcc/modbus__defs_8h.html#a15">MBF_WRITE_SINGLE_REGISTER</a>;
<a name="l00495"></a>00495         len++;
<a name="l00496"></a>00496         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, devicereg);           <span class="comment">// don't put ++ in the macro</span>
<a name="l00497"></a>00497         len+= 2;
<a name="l00498"></a>00498         <a class="code" href="../../d9/d8e/modbus__utils_8h.html#a1">PUTU16</a>( buf+ len, value);
<a name="l00499"></a>00499         len+= 2;
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         <span class="keywordflow">return</span> len;
<a name="l00502"></a>00502 }
</pre></div>
<p>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Fri Sep 9 20:27:53 2005 for Example Modbus Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.4 </small></address>
</body>
</html>
